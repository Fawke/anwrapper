/*! (c)2017 AppNexus, Inc. v10 master */
!function(t){function e(r){if(i[r])return i[r].exports;var s=i[r]={exports:{},id:r,loaded:!1};return t[r].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var r=i(1),s=i(11),n=i(8),o=i(12),a=i(14),d=i(22),l=i(28),u=i(33),h=i(37),c=i(38),p=i(40),f=i(21),g=i(31),v=i(41),m=i(42),_=i(43),b=i(34),y=i(44),w=i(9).createLogger("js.VPAIDWrapper","VPAIDWrapper"),A=i(39),E=i(10),S=function(){"use strict";this.deviceDetection=new b,this.attributes={width:0,height:0,version:"2.0",viewMode:null,bitrate:null,volume:1,duration:v.Unknown},this.urlParams=null,this.dom={slot:null,videoSlot:null,skip:{container:null,text:null,icon:null,style:null}},this.watchedElement=null,this.internalLogger=null,this.anxvvModule=null,this.disposeAttributes={globalDelay:500,globalTimeout:null,cycleDelay:50,cycleTimeout:null},this.disposeFlags={target:!1,trackingManager:!1,internalLogger:!1},this.hasDisposed=!1,this.adPlaybackStopped=!1,this.adPlaybackSkipped=!1,this.hasStarted=!1,this.target=null,this.targetAttributes={isTargetVPAID:!1,version:null},this.ad=null,this.media=null,this.trackingManager=null,this.timer=null,this.timerDelay=200,this.skip={skipOffset:null,skipTimer:!1,skippable:!1,currentCountDown:null},this.progress={progressEvents:null,progressTimer:!1},this.stopTimeout=null,this.skipTimeout=null,this.domObserver=null,this.lastObsState={videoWidth:0,slotWidth:0},this.eventManager=new s,this.playerAttributes={version:null},this.adIcons=new p,this.adIconsList=null,this.adIconTimer=null,this.adIconTimerDelay=1e3,this.adIconCounter=null,this.hasIcons=!1,w.info("VPAIDWrapper",{branch:"master",version:10})};S.prototype={getAdLinear:function(){"use strict";return!0},getAdWidth:function(){"use strict";return this.attributes.width},getAdHeight:function(){"use strict";return this.attributes.height},getAdExpanded:function(){"use strict";return this.target?this.target.getAdExpanded():"fullscreen"===this.attributes.viewMode},getAdSkippableState:function(){"use strict";return!!this.target&&this.target.getAdSkippableState()},getAdRemainingTime:function(){"use strict";return this.target?this.target.getAdRemainingTime():v.Unknown},getAdDuration:function(){"use strict";return this.target?"2.0"==this.targetAttributes.version?this.target.getAdDuration():this.target.getAdRemainingTime():v.Unknown},getAdVolume:function(){"use strict";if(this.target){var t=this.target.getAdVolume();if(t>=0&&t<=1)return t}return this.attributes.volume},setAdVolume:function(t){"use strict";"number"==typeof t&&(t=this.validateVolume(t),null!==t&&(this.volumeHandle(t),this.target&&this.target.setAdVolume(t),this.anxvvModule&&this.anxvvModule.notifyEvent(o.Ad_Volume_Change)))},getAdCompanions:function(){"use strict";return this.ad?""!==this.ad.companion?this.ad.companion:this.target?this.target.getAdCompanions():"":""},get adCompanions(){"use strict";return this.getAdCompanions()},getAdIcons:function(){"use strict";try{return!!this.hasIcons||!!this.target.getAdIcons()}catch(t){return!1}},handshakeVersion:function(t){"use strict";return this.playerAttributes.version=t,w.debug("handshakeVersion",{playerVersion:t,wrapper:this.attributes.version}),this.attributes.version},initAd:function(t,e,i,r,s,o){"use strict";return w.debug("initAd",{width:t,height:e,viewMode:i,desiredBitrate:r}),this.urlParams=new d(s),this.internalLogger=new m(this.urlParams.internalLogConfig),this.internalLogger.sendInternalError(n.Init_Ad()),null!==this.urlParams.hasError?void this.notifyError(this.urlParams.hasError):(this.trackingManager=new a(this.internalLogger.sendInternalError.bind(this.internalLogger)),this.attributes.width=this.validateDimension(t),this.attributes.height=this.validateDimension(e),this.applyViewMode(i),this.attributes.bitrate=r,this.urlParams.overrideBitrate&&(this.attributes.bitrate=1500,w.info("initAd",{overrideBitrate:this.attributes.bitrate})),this.dom.slot=o.slot,this.dom.videoSlot=o.videoSlot,this.watchedElement=this.selectWatchedElement(),this.stylish(),this.domObserver=setInterval(this.observerCallback.bind(this),1e3),this.loadAd(),setTimeout(this.asyncUsersync.bind(this),0),void setTimeout(this.asyncWhiteOps.bind(this),0))},resizeAd:function(t,e,i){"use strict";w.debug("resizeAd",{width:t,height:e,viewMode:i}),t=this.validateDimension(t),e=this.validateDimension(e),this.applyViewMode(i),this.attributes.width!==t&&t>=0&&this.attributes.height!==e&&e>=0?(this.attributes.width=t,this.attributes.height=e,this.target&&this.target.resizeAd(this.attributes.width,this.attributes.height,this.attributes.viewMode)):w.debug("resizeAd",{msg:"no resize - unchanged dimensions"})},startAd:function(){"use strict";w.debug("startAd"),this.hasStarted=!0,this.target&&this.target.startAd()},stopAd:function(){"use strict";w.debug("stopAd"),this.hasDisposed?w.debug("stopAd",{message:"Ad already disposed"}):(this.target?(this.target.stopAd(),"Creative"!==this.target.type&&(this.stopTimeout=setTimeout(function(){w.warn("Timeout stopAd",{message:"Manually disposed after timeout"}),this.vpaidEventHandler(o.Ad_Stopped)}.bind(this),600))):this.dispose(o.Ad_Stopped),w.debug("stopAd",{message:"Ad Stopped"}))},pauseAd:function(){"use strict";clearInterval(this.timer),clearInterval(this.adIconTimer),this.target&&this.target.pauseAd()},resumeAd:function(){"use strict";this.timer=setInterval(this.checkTimer.bind(this),this.timerDelay),this.adIconTimer=setInterval(this.adIconsRendering.bind(this),this.adIconTimerDelay),this.target&&this.target.resumeAd()},expandAd:function(){"use strict";this.target&&this.target.expandAd()},collapseAd:function(){"use strict";this.target&&this.target.collapseAd()},skipAd:function(){"use strict";w.debug("skipAd"),this.hasDisposed?w.debug("skipAd",{message:"Ad already disposed"}):(this.target?(this.target.skipAd(),"Creative"!==this.target.type&&(this.skipTimeout=setTimeout(function(){w.warn("Timeout skip",{message:"Manually disposed after timeout"}),this.vpaidEventHandler(o.Ad_Skipped)}.bind(this),600))):this.dispose(o.Ad_Skipped),w.debug("skipAd",{message:"Ad Skipped"}))},subscribe:function(t,e,i){"use strict";this.eventManager.subscribe(t,e,i)},unsubscribe:function(t,e,i){"use strict";this.eventManager.unsubscribe(t,e,i)},stylish:function(){"use strict";this.dom.slot.style.margin=0,this.dom.slot.style.padding=0,""===this.dom.slot.id&&w.logLevel!==w.levelNames.none&&(this.dom.slot.id="AdSlot");try{window.frameElement.style.border="0 none",window.frameElement.frameborder=0,window.frameElement.style.margin=0,window.frameElement.style.padding=0,document.body.style.margin=0,document.body.style.padding=0,document.body.style.width="100%",document.body.style.height="100%",window.frameElement.allowfullscreen="true",window.frameElement.webkitallowfullscreen="true",window.frameElement.mozallowfullscreen="true",window.frameElement.scrolling="no",this.dom.videoSlot.style["pointer-events"]="auto",this.dom.slot.style["pointer-events"]="auto"}catch(t){}},loadAd:function(){"use strict";if(null!==this.urlParams.vast){var t=new l(this.vastResultHandler.bind(this),this.vastErrorHandler.bind(this),this.urlParams.xhrCookieCredentials);t.handler(0,this.urlParams.vast)}else this.notifyError(n.Missing_Vast_Config_Error())},vastResultHandler:function(t){"use strict";if(this.hasDisposed)return void w.debug("cancel vast result due to dispose state:"+this.hasDisposed);this.ad=t,this.initANXVVModule(),setTimeout(function(){try{for(var t=_.validate(this.ad.adVerifications),e=0;e<t.length;e++)this.internalLogger.sendInternalError(t[e])}catch(i){w.error("Exception",{exception:i,message:i.message})}}.bind(this),0),this.initTrackingEvents();var e=new u(this.ad.mediaFiles,this.dom.videoSlot,this.deviceDetection);return this.attributes.bitrate<=0&&(this.attributes.bitrate=e.defaultBitrate),this.media=e.getMedia(this.attributes.width,this.attributes.height,this.attributes.bitrate),this.media?(this.initTarget(),this.anxvvModule&&(this.anxvvModule.initIas(this.watchedElement,this.internalLogger),this.anxvvModule.initDV(this.watchedElement,this.dom.slot,{subscribe:this.eventManager.subscribe.bind(this.eventManager),unsubscribe:this.eventManager.unsubscribe.bind(this.eventManager),getPreviousEvents:this.eventManager.getPreviousEvents.bind(this.eventManager)},this.internalLogger)),void this.stylishForClickthrough()):void this.notifyError(n.Media_File_Mime_Type_Error())},vastErrorHandler:function(t,e){"use strict";switch(t.severity){case n.SEVERITY.FATAL:e&&(this.ad={errors:e},this.initTrackingEvents()),this.notifyError(t);break;default:this.internalLogger.sendInternalError(t)}},initTarget:function(){"use strict";this.targetAttributes.isTargetVPAID="apiFramework"in this.media&&"vpaid"==this.media.apiFramework.toLowerCase(),this.targetAttributes.isTargetVPAID?this.media.type.toLowerCase().indexOf("javascript")>-1?(this.target=new h(this.media.url,this),this.target.loadProxy()):this.notifyError(n.Media_File_Mime_Type_Error(this.media.url)):(this.targetAttributes.version="2.0",this.target=new c(this.media.url,this,this.deviceDetection),this.target.loadPlayer())},vpaidEventHandler:function(t,e,i,r){"use strict";if(this.eventManager.alreadySent(t))return void w.debug("vpaidEventHandler",{message:"Event "+t+" already dispatched"});if(!(this.adPlaybackStopped&&t!==o.Ad_Stopped||this.adPlaybackSkipped)){if(t!=o.Ad_Stopped&&t!=o.Ad_Skipped&&t!=o.Ad_Video_Complete||(this.adPlaybackStopped=!0),t==o.Ad_Skipped&&(this.adPlaybackSkipped=!0),t==o.Ad_Click_Thru)r=this.clickThruHandle(e,r),setTimeout(function(){this.eventManager.onlyOnce.Ad_Click_Thru=!1}.bind(this),500);else if(t==o.Ad_Video_Start)this.initTrkjsViewability(),this.videoStartHandle();else if(t==o.Ad_Volume_Change){var s=0;if(void 0!==e?(s=this.validateVolume(e),e=void 0):this.target&&(s=this.validateVolume(this.target.getAdVolume())),null!==s&&(this.anxvvModule&&this.anxvvModule.notifyEvent(o.Ad_Volume_Change),this.volumeHandle(s)),!this.hasStarted)return}else if(t==o.Ad_Size_Change){if(this.target)if("Creative"==this.target.type)"fullscreen"===this.attributes.viewMode?this.applyViewMode("fullscreen"):this.applyViewMode("normal");else{var n=this.validateDimension(this.target.getAdWidth()),a=this.validateDimension(this.target.getAdHeight());this.attributes.width!==n&&n>0&&this.attributes.height!==a&&a>0&&(this.attributes.width=n,this.attributes.height=a,this.target.attributes.viewMode="normal"===this.target.attributes.viewMode?"fullscreen":"normal",this.applyViewMode(this.target.attributes.viewMode))}}else if(t==o.Ad_Skippable_State_Change){if(this.urlParams.skipEnabled)return this.displaySkipArea(),void(this.skip.skipTimer&&(this.skip.skipTimer=!1));this.skip.skippable=!0}else if(t==o.Ad_Loaded&&this.target){var d=this.target.getAdDuration(),l=this.target.getAdRemainingTime();d>0?this.attributes.duration=d:l>0&&(this.attributes.duration=l),w.debug("Duration loaded",{duration:this.attributes.duration})}t==o.Ad_Video_Complete?this.stopTimeout=setTimeout(function(){w.warn("Timeout stop",{message:"Manually disposed after timeout"}),this.vpaidEventHandler(o.Ad_Stopped)}.bind(this),600):t==o.Ad_Stopped&&this.stopTimeout?clearTimeout(this.stopTimeout):t==o.AdSkipped&&this.skipTimeout&&clearTimeout(this.skipTimeout),this.anxvvModule&&this.anxvvModule.notifyEvent(t),t==o.Ad_Error?this.adPlaybackStopped||(w.error("vpaidEventHandler",{error:i,message:e}),this.trackingManager.notifyTrackingEvent(t,i.message),this.internalLogger.sendInternalError(i)):this.trackingManager.notifyTrackingEvent(t),this.adPlaybackStopped&&t==o.Ad_Error?this.dispose(o.Ad_Stopped):t==o.Ad_Stopped||t==o.Ad_Skipped?this.dispose(t):t==o.Ad_Error?this.dispose(t,e,i.message):this.eventManager.sendEvent(t,e,i,r)}},clickThruHandle:function(t,e){"use strict";if(e){if(""!==this.ad.videoClicks.clickThrough&&(t=this.ad.videoClicks.clickThrough),t){if("about:blank"==t)return!0;var i=null;try{i=window.open(t,"_blank")}catch(r){return this.internalLogger.sendInternalError(n.ClickThru_Error(r.toString())),!0}return null===i&&(this.internalLogger.sendInternalError(n.ClickThru_Error()),!0)}return!0}return!1},initANXVVModule:function(){"use strict";var t=this.urlParams.viewabilityConfiguration,e=E.getNestedProperty(this.ad,"extensions.monetizeViewabilityConfig.TRKJSConfig.content"),i=E.getNestedProperty(this.ad,"extensions.monetizeViewabilityConfig.IASConfig.content"),s=E.getNestedProperty(this.ad,"extensions.monetizeViewabilityConfig.DVConfig.content");e||(w.debug("initANXVVModule",{message:"Using deprecated MSANViewBeacon location for trkjsConfig"}),e=E.getNestedProperty(this.ad,"extensions.MSANViewBeacon.content"));var n=new y(t,e,i,s),o=n.mergeConfig();if(t){var a=function(){return this.attributes.viewMode},d=function(){return this.attributes.volume},l=function(){return this.attributes.duration},u=function(){return{adWidth:this.attributes.width,adHeight:this.attributes.height}};this.anxvvModule=new r(o,d.bind(this),a.bind(this),l.bind(this),u.bind(this))}},initTrkjsViewability:function(){"use strict";var t=0,e=0;if(this.target&&(t=this.target.getAdDuration(),e=this.target.getAdRemainingTime()),t>0)this.attributes.duration=t;else if(e>0)this.attributes.duration=e;else if(this.attributes.duration<=0){var i=this.ad.duration.toSecond();this.attributes.duration=i!==-1?i:0}if(this.anxvvModule)try{var r=this.watchedElement;r||(this.internalLogger.sendInternalError(n.Viewability_Element_Error()),w.info("No usable element for viewability. Watched element",{selectedObject:"videoSlot fallback"}),r=this.dom.videoSlot),this.anxvvModule.initAppNexus(r,this.dom.videoSlot,this.dom.slot,this.attributes.duration,this.internalLogger)}catch(s){this.internalLogger.sendInternalError(n.Core_Js_Error())}else this.internalLogger.sendInternalError(n.Missing_View_Config_Error())},videoStartHandle:function(){"use strict";var t=Math.floor(1e3*this.attributes.duration);if(this.skip.skipOffset=new g(this.ad.skip,t),this.skip.skipOffset.toSecond()>=0&&(this.skip.skipTimer=!0),this.ad.trackingEvents.hasOwnProperty("progress")){this.progress.progressEvents=this.ad.trackingEvents.progress;for(var e=0;e<this.progress.progressEvents.length;e++){this.progress.progressEvents[e].sent=!1;var i=this.progress.progressEvents[e].offset;this.progress.progressEvents[e].offset=new g(i,t),this.progress.progressEvents[e].offset.toSecond()<0&&(this.progress.progressEvents[e].sent=!0)}this.progress.progressTimer=!0}(this.skip.skipTimer||this.progress.progressTimer)&&(this.timer=setInterval(this.checkTimer.bind(this),this.timerDelay)),this.adIconSetup()},volumeHandle:function(t){"use strict";t!==this.attributes.volume&&(0===t?(w.debug("volumeHandle",{status:"Mute"}),this.trackingManager.notifyTrackingEvent("Mute")):0!==t&&0===this.attributes.volume&&(w.debug("volumeHandle",{status:"Unmute"}),this.trackingManager.notifyTrackingEvent("Unmute")),this.attributes.volume=t)},checkTimer:function(){"use strict";var t=!0;if(this.progress.progressTimer){for(var e=0;e<this.progress.progressEvents.length;e++)if(!this.progress.progressEvents[e].sent){var i=this.progress.progressEvents[e].offset.decrease(this.timerDelay);if(i){var r=this.progress.progressEvents[e].url;this.progress.progressEvents[e].sent=!0,r=f.replaceMacro(r),this.trackingManager.send(r)}else t=!1}t&&(this.progress.progressTimer=!1)}if(this.skip.skipTimer&&!this.skip.skippable){this.skip.skippable=this.skip.skipOffset.decrease(this.timerDelay);var s=this.skip.skipOffset.toSecond();this.skip.skippable||this.skip.currentCountDown==s||(this.displaySkipArea(s),this.skip.currentCountDown=s),this.skip.skippable?this.urlParams.skipEnabled?(this.displaySkipArea(),this.skip.skippable=!1,this.skip.skipTimer=!1):(w.info("checkTimer",{eventType:o.Ad_Skippable_State_Change}),this.eventManager.sendEvent(o.Ad_Skippable_State_Change)):t=!1}t&&clearInterval(this.timer)},dispose:function(t,e,i){"use strict";w.debug("dispose",{willDispose:!this.hasDisposed});try{if(this.hasDisposed||t!==o.Ad_Stopped&&t!==o.Ad_Skipped&&t!==o.Ad_Error)this.hasDisposed&&t===o.Ad_Stopped&&this.eventManager.sendEvent(o.Ad_Stopped);else{this.hasDisposed=!0,clearInterval(this.timer),clearInterval(this.domObserver),this.adIconTimer&&(this.adIconCounter=this.attributes.duration,this.adIconsRendering()),this.disposeSkipArea(),this.target?this.target.dispose():this.disposeFlags.target=!0,this.trackingManager?this.trackingManager.dispose(this):this.disposeFlags.trackingManager=!0,this.internalLogger?this.internalLogger.dispose(this):this.disposeFlags.internalLogger=!0;var r=function(){for(var r in this.disposeFlags)if(!this.disposeFlags[r])return!1;return this.disposeAttributes.globalTimeout&&(clearTimeout(this.disposeAttributes.globalTimeout),this.disposeAttributes.globalTimeout=null),this.disposeAttributes.cycleTimeout&&(clearInterval(this.disposeAttributes.cycleTimeout),this.disposeAttributes.cycleTimeout=null),this.eventManager.sendEvent(t,e,i),t===o.Ad_Skipped&&this.eventManager.sendEvent(o.Ad_Stopped),!0}.bind(this);r()||(this.disposeAttributes.cycleTimeout=setInterval(r,this.disposeAttributes.cycleDelay),this.disposeAttributes.globalTimeout=setTimeout(function(){this.disposeAttributes.cycleTimeout&&(clearInterval(this.disposeAttributes.cycleTimeout),this.disposeAttributes.cycleTimeout=null),this.disposeAttributes.globalTimeout=null,this.eventManager.sendEvent(t,e,i)}.bind(this),this.disposeAttributes.globalDelay))}}catch(s){throw w.error("dispose exception:"+s),s}},notifyError:function(t){"use strict";this.trackingManager&&this.trackingManager.notifyTrackingEvent(o.Ad_Error,t.code),this.internalLogger.sendInternalError(t),this.dispose(o.Ad_Error,"",t.code)},initTrackingEvents:function(){"use strict";"errors"in this.ad&&this.trackingManager.addTrackingEvent("error",this.ad.errors),"impressions"in this.ad&&this.trackingManager.addTrackingEvent("impression",this.ad.impressions),"trackingEvents"in this.ad&&this.trackingManager.addTrackingEvents(this.ad.trackingEvents),"videoClicks"in this.ad&&this.trackingManager.addTrackingEvent("clickTracking",this.ad.videoClicks.clickTracking)},validateVolume:function(t){"use strict";return"number"==typeof t?(t=Math.floor(100*t)/100,t<=0?t=0:t>=1&&(t=1),t):null},validateDimension:function(t){"use strict";if("number"==typeof t)return t;if("string"==typeof t){var e=t.match(/^(\d+)px$/);if(e&&e[1])return e[1]}return 0},applyViewMode:function(t){"use strict";return t="string"!=typeof t||t.search(/normal|fullscreen/i)===-1?"normal":t.toLowerCase(),this.attributes.viewMode!=t&&(this.attributes.viewMode=t,"fullscreen"===t?this.trackingManager.notifyTrackingEvent("Expand"):this.trackingManager.notifyTrackingEvent("Collapse"),this.attributes.viewMode=t,this.anxvvModule&&this.anxvvModule.notifyEvent(o.Ad_Size_Change)),t},selectWatchedElement:function(){"use strict";var t=function(t,e,i){return!!t&&!(t.clientWidth!==e&&t.offsetWidth!==e||t.clientHeight!==i&&t.offsetHeight!==i)},e=this.dom.videoSlot;try{document.body.contains(e)}catch(i){w.debug("Fake video element detected",i),this.internalLogger.sendInternalError(n.Fake_VideoSlot_Element_Error()),e=null}if(e&&t(e,this.attributes.width,this.attributes.height))return w.info("Watched element",{selectedObject:"videoSlot"}),e;var r=this.dom.slot;try{document.body.contains(r)}catch(i){w.debug("Fake div element detected",i),this.internalLogger.sendInternalError(n.Fake_Slot_Element_Error()),r=null}if(r&&t(r,this.attributes.width,this.attributes.height))return w.info("Watched element",{selectedObject:"slot"}),r;var s=document.body;try{document.body.contains(s)}catch(i){w.debug("Fake body element detected",i),s=null}return s&&t(s,this.attributes.width,this.attributes.height)?(w.info("Watched element",{selectedObject:"body"}),s):e?(w.info("Watched element",{selectedObject:"videoSlot fallback"}),e):r?(w.info("Watched element",{selectedObject:"slot fallback"}),r):null},observerCallback:function(){"use strict";if(this.deviceDetection.getIsIOS()&&void 0!==this.dom.videoSlot.webkitDisplayingFullscreen){if(this.dom.videoSlot.webkitDisplayingFullscreen!==("fullscreen"===this.attributes.viewMode)){w.debug("Resize observer",{source:"ios fullscreen"});var t=this.dom.videoSlot.webkitDisplayingFullscreen?"fullscreen":"normal";this.applyViewMode(t),this.target&&this.target.resizeAd(this.attributes.width,this.attributes.height,t)}}else{var e={width:0,height:0,viewmode:this.attributes.viewMode,changed:!1},i={width:0,height:0,viewmode:this.attributes.viewMode,changed:!1};this.hasResized(this.dom.videoSlot,e),this.hasResized(this.dom.slot,i),e.changed&&this.lastObsState.videoWidth!=e.width?(w.debug("Resize observer",{source:"video tag"}),this.resizeAd(e.width,e.height,e.viewmode)):i.changed&&this.lastObsState.slotWidth!=i.width&&(w.debug("Resize observer",{source:"slot div"}),this.resizeAd(i.width,i.height,i.viewmode)),this.lastObsState.videoWidth=e.width,this.lastObsState.slotWidth=i.width}},hasResized:function(t,e){"use strict";if(t&&(t.clientWidth&&t.clientHeight||t.offsetWidth&&t.offsetHeight)){var i=10;t.clientWidth&&t.clientHeight?(e.width=t.clientWidth,e.height=t.clientHeight):t.offsetWidth&&t.offsetHeight&&(e.width=t.offsetWidth,e.height=t.offsetHeight),Math.abs(e.width-this.attributes.width)>i&&Math.abs(e.height-this.attributes.height)>i&&(e.changed=!0),e.width>this.attributes.width&&this.attributes.width>i&&this.attributes.height>i?e.viewmode="fullscreen":e.width<this.attributes.width&&(e.viewmode="normal")}},adIconSetup:function(){"use strict";if(0!==this.ad.icons.length){if(this.target&&this.target.getAdIcons())return void w.debug("adIconSetup",{message:"Client already have icons"});if(this.adIcons.init(this.ad.icons),this.adIconsList=this.adIcons.getIcons(),!this.adIconsList||0===this.adIconsList.length)return;this.hasIcons=!0,this.adIconCounter=.1,this.adIconsRendering(),this.adIconTimer=setInterval(this.adIconsRendering.bind(this),this.adIconTimerDelay)}},adIconsTrackingCallback:function(t){w.debug("icon tracking callback",{eventKey:t});var e=t.split("_");if(2===e.length)for(var i=0;i<this.adIconsList.length;i++)if(this.adIconsList[i].program===e[1]){var r=[];"IconViewTracking"===e[0]?r=this.adIconsList[i].IconViewTracking:"IconClickTracking"===e[0]&&(r=this.adIconsList[i].IconClickTracking);for(var s=0;s<r.length;s++)this.trackingManager.send(f.replaceMacro(r[s]))}},adIconsClickCallback:function(t){if(w.debug("icon click callback",{url:t}),t&&"string"==typeof t&&"about:blank"!==t){var e=null;try{e=window.open(t,"_blank")}catch(i){this.internalLogger.sendInternalError(n.Icon_ClickThru_Error())}null===e&&this.internalLogger.sendInternalError(n.Icon_ClickThru_Error())}},adIconsRendering:function(){this.adIconCounter>this.attributes.duration&&clearInterval(this.adIconTimer),this.adIcons.renderIcons(this.adIconsTrackingCallback.bind(this),this.adIconsClickCallback.bind(this),this.dom.slot,0,0,this.adIconCounter,this.attributes.duration),this.adIconCounter++},asyncUsersync:function(){"use strict";try{if(this.urlParams&&this.urlParams.dropUsersync&&this.urlParams.usersyncUrl&&""!==this.urlParams.usersyncUrl){var t=window.document.createElement("iframe");t.src=this.urlParams.usersyncUrl,t.width="1",t.height="1",t.frameborder="0",t.scrolling="no",t.marginheight="0",t.marginwidth="0",t.topmargin="0",t.leftmargin="0",t.style.position="absolute",t.style.overflow="hidden",t.style.clip="rect(0 0 0 0)",t.style.height="1px",t.style.width="1px",t.style.margin="-1px",t.style.padding="0",t.style.border="0",window.document.body.appendChild(t),w.info("dropUsersync")}}catch(e){w.error("dropUsersync",{message:"Error while dropping usersync",error:e.message})}},asyncWhiteOps:function(){"use strict";try{if(this.urlParams&&this.urlParams.whiteOpsUrl&&""!==this.urlParams.whiteOpsUrl){var t=this.dom.slot.ownerDocument.createElement("script");t.type="text/javascript",t.src=this.urlParams.whiteOpsUrl,this.dom.slot.appendChild(t),this.internalLogger.sendInternalError(n.WhiteOps_Dropped())}}catch(e){w.error("dropWhiteOps",{message:"Error while dropping WhiteOps JS",error:e.message})}},displaySkipArea:function(t){"use strict";if(this.urlParams.skipEnabled){if(!this.dom.skip.style){this.dom.skip.style=this.dom.slot.ownerDocument.createElement("style"),this.dom.skip.style.appendChild(this.dom.slot.ownerDocument.createTextNode("")),this.dom.slot.appendChild(this.dom.skip.style);var e=this.dom.skip.style.sheet,i="#anSkipButton",r="#anSkipText",s="#anSkipIcon";this.dom.slot.id&&(i="#"+this.dom.slot.id+">"+i);for(var n=[{selector:i,rule:"white-space: nowrap; text-align:center; min-width:130px; position:absolute; bottom:35px; right:5px; margin:0; padding:5px; border:1px solid white; border-radius:10px; background:black; color:white; cursor:default; opacity:0.7;"},{selector:i+">"+r,rule:"margin:0; padding:0; line-height:18px; font-family:Arial,Helvetica,sans-serif; font-size:15px; font-style:normal; font-weight:lighter;"},{selector:i+">"+s,rule:"margin:0 0 0 10px; padding:0; width:11px; height:11px;"},{selector:i+".skippable",rule:"cursor: pointer; z-index: "+A.SKIP_BUTTON_ZINDEX+";"}],o=0;o<n.length;o++){var a=n[o];"addRule"in e?e.addRule(a.selector,a.rule,0):"insertRule"in e&&e.insertRule(a.selector+"{"+a.rule+"}",0)}}if(!this.dom.skip.container){var d=document.createElement("div");d.id="anSkipButton",this.dom.slot.appendChild(d),this.dom.skip.container=d}if(!this.dom.skip.text){var l=document.createElement("span");l.id="anSkipText",this.dom.skip.container.appendChild(l),this.dom.skip.text=l}if(t?this.dom.skip.text.innerHTML="You can skip in "+t+"s":this.dom.skip.text.innerHTML="Skip Ad",!this.dom.skip.icon&&!t){var u=document.createElement("img");u.id="anSkipIcon",u.src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCIgdmlld0JveD0iMCAwIDMwNiAzMDYiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwNiAzMDY7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPGc+Cgk8ZyBpZD0ic2tpcC1uZXh0Ij4KCQk8cGF0aCBkPSJNMCwzMDZsMjE2Ljc1LTE1M0wwLDBWMzA2eiBNMjU1LDB2MzA2aDUxVjBIMjU1eiIgZmlsbD0iI0ZGRkZGRiIvPgoJPC9nPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=",this.dom.skip.container.appendChild(u),this.dom.skip.icon=u,this.dom.skip.container.classList.add("skippable"),this.dom.skip.container.addEventListener("click",this.skipAd.bind(this))}}},disposeSkipArea:function(){"use strict";this.dom.skip.container&&(this.dom.skip.container.removeEventListener("click",this.skipAd.bind(this)),this.dom.slot.removeChild(this.dom.skip.container),this.dom.skip.container=null,this.dom.skip.text=null,this.dom.skip.icon=null),this.dom.skip.style&&(this.dom.slot.removeChild(this.dom.skip.style),this.dom.skip.style=null)},skipHandler:function(t){"use strict";t.stopImmediatePropagation(),this.skipAd()},stylishForClickthrough:function(){"use strict";try{if(this.ad.videoClicks.clickThrough){var t=window.getComputedStyle(this.dom.slot).cursor;t&&"auto"!==t||(this.dom.slot.style.cursor="pointer")}}catch(e){}}},getVPAIDAd=function(){return new S}},function(t,e,i){var r=i(2),s=i(2).Ias.ERROR_CODE,n=i(2).DV.ERROR_CODE,o=i(8),a=i(9).createLogger("js.viewability.ANXVVModule","ANXVVModule"),d=function(t,e,i,r,s){"use strict";this.view=null,this.viewMode="normal",this.configure(t,e,i,r,s)};d.prototype={configure:function(t,e,i,s,n){"use strict";var o={loggerCallback:this.log.bind(this),getVolumeCallback:e,getViewModeCallback:i,getAdDurationCallback:s,getAdDimensionCallback:n};this.view=new r(t,o)},initAppNexus:function(t,e,i,s,n){"use strict";var d={duration:s},l={errorCallback:function(t,e){this.log(r.LOG_LEVEL.ERROR,e+" Module ERROR_CODE="+t),n&&n.sendInternalError(o.Core_Js_Error())}.bind(this),videoElementsCallback:function(){return{videoElement:e,videoContainer:i}}};this.view.initAppNexus(t,d,void 0,l),a.info("initAppNexus",{duration:s})},initIas:function(t,e){"use strict";var i={errorCallback:function(t,i){if(this.log(r.LOG_LEVEL.DEBUG,i+" Module ERROR_CODE="+t),e)switch(t){case s.BAD_CONFIG:e.sendInternalError(o.Ias_Config_Error());break;case s.LIBRARY_LOADING_ERROR:e.sendInternalError(o.Ias_Loading_Error());break;case s.INITIALIZATION_ERROR:e.sendInternalError(o.Ias_Error())}}.bind(this)};this.view.initIas(t,i)},initDV:function(t,e,i,s){"use strict";var a={errorCallback:function(t,e){if(this.log(r.LOG_LEVEL.DEBUG,e+" Module ERROR_CODE="+t),s)switch(t){case n.BAD_CONFIG:s.sendInternalError(o.Dv_Config_Error());break;case n.LIBRARY_LOADING_ERROR:s.sendInternalError(o.Dv_Loading_Error());break;case n.INITIALIZATION_ERROR:s.sendInternalError(o.Dv_Error());break;default:this.log(r.LOG_LEVEL.ERROR,"Unknown DV error code: "+t)}}.bind(this),subscribe:i.subscribe,unsubscribe:i.unsubscribe,getPreviousEvents:i.getPreviousEvents};this.view.initDV(t,e,a)},notifyEvent:function(t){"use strict";this.view.notifyEvent(t)},log:function(t,e,i){"use strict";var r={message:e};i&&(r.data=i),a[t]?a[t]("ViewJS Proxy",r):(r.level=t,a.warn("ViewJS Proxy lost message",r))}},t.exports=d},function(t,e,i){!function(){"use strict";var e=i(3);t.exports=e}()},function(t,e,i){"use strict";var r=i(4),s=i(6),n=i(7),o=i(5).LOG_LEVEL,a=i(5).VIEW_EVENT,d=i(5).VPAID_EVENT,l=i(5).VIEW_MODE,u=i(5).MODULE,h=function(t,e){p.call(this,t,e)};h.prototype={initAppNexus:function(t,e,i,r){try{this._private.initAppNexus(t,e,i,r)}catch(s){this._private,_debug&&console.error("exception in initAppNexus",s)}return this},initIas:function(t,e){try{this._private.initIas(t,e)}catch(i){this._private._debug&&console.error("exception in initIas",i)}return this},initDV:function(t,e,i){try{this._private.initDV(t,e,i)}catch(r){this._private._debug&&console.error("exception in initDV",r)}return this},notifyEvent:function(t){try{this._private.notifyEvent(t)}catch(e){this._private._debug&&console.error("exception in notifyEvent",e)}return this}},t.exports=h,t.exports.LOG_LEVEL=o,t.exports.VIEW_EVENT=a,t.exports.VPAID_EVENT=d,t.exports.VIEW_MODE=l,t.exports.MODULE=u,t.exports.AppNexus=r,t.exports.Ias=s,t.exports.DV=n;var c=function(){this._debug=!1,this._viewabilityParams={},this._viewabilityModules={},this._service={}},p=function(t,e){try{this._private=new c,this._private._service=e,t&&this._private.configure(t)}catch(i){this.log(o.ERROR,"'_init' failed:",i)}};c.prototype={log:function(t,e,i){try{if(this._service.loggerCallback)try{this._service.loggerCallback(t,"[VVAdaptor] "+e,i)}catch(r){this._debug&&console.trace(r)}else this._debug&&console.log(t+": "+e,i)}catch(r){this._debug&&console.trace(r)}},configure:function(t){this._viewabilityParams={},this._viewabilityModules={},this.configureAppNexus(t),this.configureThirdPartyProviders(t)},configureAppNexus:function(t){try{t.hasOwnProperty("config")&&""!==t.config&&(this._viewabilityParams[u.APPNEXUS]=t.config)}catch(e){this.log(o.ERROR,"'configure' failed for MODULE.APPNEXUS: ",e)}},configureThirdPartyProviders:function(t){if(t.hasOwnProperty("third_party_providers")){var e=t.third_party_providers;for(var i in e)try{this.configureProvider(e[i])}catch(r){this.log(o.ERROR,"'configure' failed for provider "+e[i].code+": ",r)}}},configureProvider:function(t){if(!t.hasOwnProperty("code")||!t.hasOwnProperty("config")||""===t.config)return void this.log(o.ERROR,"Invalid provider configuration");switch(t.code.toLowerCase()){case"ias":this._viewabilityParams[u.IAS]=t.config;break;case"dv":this._viewabilityParams[u.DV]=t.config;break;default:this.log(o.INFO,"Unknown provider code: "+t.code)}},initAppNexus:function(t,e,i,s){try{this._viewabilityModules[u.APPNEXUS]=null;var n=this._viewabilityParams[u.APPNEXUS];
if(n&&s){s.loggerCallback=this._service.loggerCallback;var a=this.getVolume(),d=this.getViewMode();this._viewabilityModules[u.APPNEXUS]=new r(n,t,e,i,a,d,s),a&&(this.lastKnownVolume=a),d&&(this.lastKnownViewMode=d)}}catch(l){this.log(o.ERROR,"'initAppNexus' failed:",l)}},initIas:function(t,e){try{this._viewabilityModules[u.IAS]=null;var i=this._viewabilityParams[u.IAS];i&&e&&(e.loggerCallback=this._service.loggerCallback,e.getVolumeCallback=this._service.getVolumeCallback,e.getAdDimensionCallback=this._service.getAdDimensionCallback,e.getAdDurationCallback=this._service.getAdDurationCallback,e.getViewModeCallback=this._service.getViewModeCallback,this._viewabilityModules[u.IAS]=new s(t,i,e,this._debug))}catch(r){this.log(o.ERROR,"'initIas' failed for MODULE.IAS: ",r)}},initDV:function(t,e,i){try{this._viewabilityModules[u.DV]=null;var r=this._viewabilityParams[u.DV];r&&i&&(i.loggerCallback=this._service.loggerCallback,i.getVolumeCallback=this._service.getVolumeCallback,this._viewabilityModules[u.DV]=new n(t,e,r,i,this._debug))}catch(s){this.log(o.ERROR,"'initDV' failed for MODULE.DV: ",s)}},notifyEvent:function(t){var e=null,i=null,r=null;if(this._viewabilityModules[u.APPNEXUS])try{var s=null;switch(t){case d.Ad_Video_Start:s=a.START;break;case d.Ad_Stopped:case d.Ad_Skipped:s=a.STOP;break;case d.Ad_Paused:s=a.PAUSE;break;case d.Ad_Playing:s=a.RESUME;break;case d.Ad_Click_Thru:s=a.CLICK;break;case d.Ad_Size_Change:case d.Ad_Expanded_Change:case d.Ad_User_Minimize:i=null!==i?i:this.getNewViewMode(),null!==i&&this._viewabilityModules[u.APPNEXUS].onViewModeChange(i);break;case d.Ad_Volume_Change:e=null!==e?e:this.getNewVolume(),null!==e&&this._viewabilityModules[u.APPNEXUS].onVolumeChange(e);break;case a.START:case a.STOP:case a.PAUSE:case a.RESUME:case a.CLICK:s=t;break;case a.FULL_SCREEN:case a.EXIT_FULL_SCREEN:i=null!==i?i:this.getNewViewMode(),null!==i&&this._viewabilityModules[u.APPNEXUS].onViewModeChange(i);break;case a.SOUND_OFF:case a.SOUND_ON:e=null!==e?e:this.getNewVolume(),null!==e&&this._viewabilityModules[u.APPNEXUS].onVolumeChange(e)}null!==s&&this._viewabilityModules[u.APPNEXUS].notifyEvent(s)}catch(n){this.log(o.ERROR,"'notifyEvent' failed for event '"+t+"' with MODULE.APPNEXUS: "+n.message,n.stack)}if(this._viewabilityModules[u.IAS])try{var l=null;switch(t){case d.Ad_Volume_Change:e=null!==e?e:this.getNewVolume(),null!==e&&(l=t);break;case d.Ad_Size_Change:case d.Ad_Expanded_Change:case d.Ad_User_Minimize:i=null!==i?i:this.getNewViewMode(),null!==i&&(l=t);break;case d.Ad_Remaining_Time_Change:case d.Ad_Duration_Change:r=null!==r?r:this.getNewAdDuration(),null!==r&&(l=t);break;case d.Ad_Click_Thru:case d.Ad_Error:case d.Ad_Impression:case d.Ad_Interaction:case d.Ad_Linear_Change:case d.Ad_Loaded:case d.Ad_Log:case d.Ad_Paused:case d.Ad_Playing:case d.Ad_Skippable_State_Change:case d.Ad_Skipped:case d.Ad_Started:case d.Ad_Stopped:case d.Ad_User_Accept_Invitation:case d.Ad_User_Close:case d.Ad_Video_Start:case d.Ad_Video_First_Quartile:case d.Ad_Video_Midpoint:case d.Ad_Video_Third_Quartile:case d.Ad_Video_Complete:l=t}null!==l&&this._viewabilityModules[u.IAS]&&this._viewabilityModules[u.IAS].notifyVPAIDEvent(l)}catch(n){this.log(o.ERROR,"'notifyEvent' failed for event '"+t+"' with MODULE.IAS: "+n.message,n.stack)}null!==e&&(this.lastKnownVolume=e),null!==i&&(this.lastKnownViewMode=i),null!==r&&(this.lastKnownAdDuration=r)},lastKnownVolume:-1,getVolume:function(){var t=this._service.getVolumeCallback();return"number"==typeof t?t:null},getNewVolume:function(){var t=this.getVolume();return null!==t&&t!==this.lastKnownVolume?t:null},lastKnownViewMode:l.NORMAL,getViewMode:function(){var t=this._service.getViewModeCallback();if("string"==typeof t){switch(t){case l.NORMAL:case l.FULL_SCREEN:break;default:t=l.NORMAL}return t}return null},getNewViewMode:function(){var t=this.getViewMode();return null!==t&&t!==this.lastKnownViewMode?t:null},lastKnownAdDuration:-1,getAdDuration:function(){var t=this._service.getAdDurationCallback();return"number"==typeof t?t:null},getNewAdDuration:function(){var t=this.getAdDuration();return null!==t&&t!==this.lastKnownAdDuration?t:null}}},function(t,e,i){var r=i(5).LOG_LEVEL,s=i(5).VIEW_MODE,n={NO_VIEWABILITY_DATA:100,MISSING_MANDATORY_PARAMETER_JS:101,FAILED_TO_LOAD_VIEWABILITY_JS:102,INITIALIZATION_FAILED:103,MISSING_MANDATORY_PARAMETER_CB:104,MISSING_MANDATORY_PARAMETER_RDCB:105,MISSING_MANDATORY_PARAMETER_VC:106},o=function(t,e,i,s,o,a,d){"use strict";if(this.contextKey=s,this.service=d||{},this.adUID="WR_"+(new Date).getTime()+Math.round(1e3*Math.random()),this.viewabilityMeasurementActive=!0,this.viewabilityData=this.decodePayload(t),!this.viewabilityData)return void(this.viewabilityMeasurementActive=!1);if(this.contextKey&&""!==this.contextKey&&(this.log(r.INFO,"contextKey is set in this app, checking contextKey in viewability config"),!this.viewabilityData.hasOwnProperty("contextKey")||this.viewabilityData.contextKey.indexOf(this.contextKey)===-1))return this.log(r.INFO,"contextKey doesn't match, disabling viewability measurement"),void(this.viewabilityMeasurementActive=!1);var l="";try{"object"==typeof e?(this.videoNodeDocument=e.ownerDocument,this.videoNodeWindow=this.videoNodeDocument.defaultView||this.videoNodeDocument.videoNodeWindow,""===e.id&&(e.id="an_video_"+this.adUID),l=e.id):(l=e,this.videoNodeDocument=document,this.videoNodeWindow=window)}catch(u){this.videoNodeDocument=document,this.videoNodeWindow=window}var h={};"function"==typeof this.service.videoElementsCallback&&(h=this.service.videoElementsCallback()),this.videoInfo=this.decodeVideoInfos(i);var c={DomID:l,adUID:this.adUID,Duration:this.videoInfo.duration,Payload:t,Dimension:{w:this.videoInfo.w,h:this.videoInfo.h},Position:{x:this.videoInfo.x,y:this.videoInfo.y}};"undefined"!=typeof h.videoElement&&(c.videoElement=h.videoElement),"undefined"!=typeof h.videoContainer&&(c.videoContainer=h.videoContainer),this.log(r.INFO,"ANVideoViewabilityTracker start with parameters",c);try{if("undefined"==typeof this.videoNodeWindow.anxVVAPICache){this.videoNodeWindow.anxVVAPICache={events:Array(),init:Array()};var p=this.videoNodeDocument.createElement("script");p.type="text/javascript",p.async=!0,p.src=this.viewabilityData.vjs,p.readyState&&(p.onreadystatechange=function(){"loaded"!=p.readyState&&"complete"!=p.readyState||(p.onreadystatechange=null)}),p.onerror=function(){this.log(r.DEBUG,"script load onerror"),this.error(n.FAILED_TO_LOAD_VIEWABILITY_JS,"ANVideoViewabilityTracker failed to load viewability script ("+p.src+")."),this.viewabilityMeasurementActive=!1}.bind(this);var f=this.videoNodeDocument.getElementsByTagName("head")[0];f.appendChild(p)}}catch(u){this.error(n.INITIALIZATION_FAILED,{message:"ANVideoViewabilityTracker initialization failed",exception:u})}if(this.extractVersionModule(this.viewabilityData),"undefined"==typeof this.videoNodeWindow.anxVVAPI){var g={a:this.adUID,params:this.viewabilityData.viewParams,id:l,v:this.VIEWABILITY_MODULE_VERSION,dur:this.videoInfo.duration,w:this.videoInfo.w,h:this.videoInfo.h,x:this.videoInfo.x,y:this.videoInfo.y};"undefined"!=typeof h.videoElement&&(g.videoElement=h.videoElement),"undefined"!=typeof h.videoContainer&&(g.videoContainer=h.videoContainer),this.videoNodeWindow.anxVVAPICache.init.push(g)}else this.videoNodeWindow.anxVVAPI.initializeFromParams(this.viewabilityData.viewParams,l,this.adUID,this.VIEWABILITY_MODULE_VERSION,this.videoInfo.duration,this.videoInfo.w,this.videoInfo.h,this.videoInfo.x,this.videoInfo.y,h.videoElement,h.videoContainer);null!==o&&this.onVolumeChange(o),null!==a&&this.onViewModeChange(a)};o.prototype={VIEWABILITY_MODULE_VERSION:1,log:function(t,e,i){"use strict";if(this.service.loggerCallback)try{this.service.loggerCallback(t,"[AppNexus] "+e,i)}catch(r){console.trace(r)}},error:function(t,e,i){"use strict";if(this.service.errorCallback)try{this.service.errorCallback(t,e,i)}catch(s){console.trace(s)}else this.log(r.ERROR,"ERR-"+t+": "+e,i)},parseUrl:function(t){"use strict";var e={http:"",params:""};try{if(t&&"string"==typeof t){var i=t.split(/:/);if(2===i.length&&(t=i[1],e.http=i[0]),i=t.split(/\?/),2===i.length?e.params=i[1]:(""===e.http||"//"!==t.substr(0,2))&&t.indexOf("=")>-1&&(e.params=i[0]),""!==e.params){i=e.params.split(/&/),e.params={};for(var s in i){var n=i[s].split(/=/);if(2===n.length)e.params[n[0]]=decodeURIComponent(n[1]);else if(n.length>2){for(var o="",a=1;a<n.length;a++)o+="="+n[a];e.params[n[0]]=decodeURIComponent(o.substr(1))}else e.params[n[0]]=""}}}}catch(d){this.log(r.DEBUG,d)}return e},parseConfigs:function(t){"use strict";try{if(t&&"string"==typeof t){"<![CDATA["===t.substring(0,9)&&(t=t.substring(9,t.length-3));var e=this.parseUrl(t);if(e.hasOwnProperty("params")&&""!==e.params)return e.params}}catch(i){return this.log(r.DEBUG,"Error parsing config:"+t),void this.log(r.DEBUG,i)}return this.error(n.NO_VIEWABILITY_DATA,"No viewability data provided"),null},createViewabilityConfig:function(t){var e,i=[],r=!1;for(e in t){var s=t[e];switch(e){case"cb":s||(this.error(n.MISSING_MANDATORY_PARAMETER_CB,"Missing mandatory parameter: "+e+"."),r=!0);break;case"rdcb":s||(this.error(n.MISSING_MANDATORY_PARAMETER_RDCB,"Missing mandatory parameter: "+e+"."),r=!0);break;case"vc":s||(this.error(n.MISSING_MANDATORY_PARAMETER_VC,"Missing mandatory parameter: "+e+"."),r=!0);var o=s.split(/;/);i.push("vc="+encodeURIComponent(o[0]));for(var a=1;a<o.length;a++)i.push(o[a]);continue}i.push(e+"="+encodeURIComponent(s))}return r===!0?null:(i.sort(),i.join("&"))},decodePayload:function(t){"use strict";var e=this.parseConfigs(t);if(!e)return null;var i=this.createViewabilityConfig(e);if(!i)return null;var r={viewParams:i};return e.hasOwnProperty("vjs")&&""!==e.vjs?(r.vjs=e.vjs,e.hasOwnProperty("vid_context")&&(r.contextKey=e.vid_context),r):(this.error(n.MISSING_MANDATORY_PARAMETER_JS,"no viewability script js to load"),this.viewabilityMeasurementActive=!1,null)},decodeVideoInfos:function(t){"use strict";var e={duration:0,w:0,h:0,x:0,y:0};return("number"==typeof t.duration||t.duration>0)&&(e.duration=t.duration),("number"==typeof t.w||t.w>0)&&(e.w=t.w),("number"==typeof t.h||t.h>0)&&(e.h=t.h),("number"==typeof t.x||t.x>0)&&(e.x=t.x),("number"==typeof t.y||t.y>0)&&(e.y=t.y),e},extractVersionModule:function(t){"use strict";if(t){var e=/.+\/(\d+)\/trk\.js/,i=e.exec(t.viewJS);i&&i[1]&&(this.VIEWABILITY_MODULE_VERSION=i[1])}},notifyEvent:function(t){"use strict";if(!this.viewabilityMeasurementActive)return void this.log(r.INFO,"notifyEvent cancelled because viewability is not active");switch(this.log(r.INFO,"notifyEvent: ["+t+"]"),"an_outstream"==this.contextKey&&"sound_off"==t&&(t="sound_on"),t){case"fullscreen":t="expand";break;case"exitFullscreen":t="collapse";break;case"expand":case"collapse":return}var e=(new Date).getTime();try{if("undefined"==typeof this.videoNodeWindow.anxVVAPI){var i={a:this.adUID,c:t,d:e};this.videoNodeWindow.anxVVAPICache.events.push(i)}else this.videoNodeWindow.anxVVAPI.notifyEvent(this.adUID,t)}catch(s){this.log(r.DEBUG,{message:"notifyEvent failed",exception:s})}},lastKnownVolume:-1,onVolumeChange:function(t){"use strict";return this.viewabilityMeasurementActive?(t>1&&(t=1),t<0&&(t=0),void(t!==this.lastKnownVolume&&(t>0?this.notifyEvent("sound_on"):this.notifyEvent("sound_off"),this.lastKnownVolume=t))):void this.log(r.INFO,"onVolumeChange cancelled because viewability is not active")},onViewModeChange:function(t){"use strict";return this.viewabilityMeasurementActive?void(t==s.NORMAL?this.notifyEvent("exitFullscreen"):this.notifyEvent("fullscreen")):void this.log(r.INFO,"onViewModeChange cancelled because viewability is not active")}},t.exports=o,t.exports.LOG_LEVEL=r,t.exports.ERROR_CODE=n},function(t,e){var i={DEBUG:"debug",INFO:"info",ERROR:"error"},r={START:"start",STOP:"stop",PAUSE:"pause",RESUME:"resume",FULL_SCREEN:"fullscreen",EXIT_FULL_SCREEN:"exitFullscreen",CLICK:"click",SOUND_OFF:"sound_off",SOUND_ON:"sound_on"},s={Ad_Loaded:"AdLoaded",Ad_Started:"AdStarted",Ad_Stopped:"AdStopped",Ad_Skipped:"AdSkipped",Ad_Skippable_State_Change:"AdSkippableStateChange",Ad_Size_Change:"AdSizeChange",Ad_Linear_Change:"AdLinearChange",Ad_Duration_Change:"AdDurationChange",Ad_Expanded_Change:"AdExpandedChange",Ad_Remaining_Time_Change:"AdRemainingTimeChange",Ad_Volume_Change:"AdVolumeChange",Ad_Impression:"AdImpression",Ad_Video_Start:"AdVideoStart",Ad_Video_First_Quartile:"AdVideoFirstQuartile",Ad_Video_Midpoint:"AdVideoMidpoint",Ad_Video_Third_Quartile:"AdVideoThirdQuartile",Ad_Video_Complete:"AdVideoComplete",Ad_Click_Thru:"AdClickThru",Ad_Interaction:"AdInteraction",Ad_User_Accept_Invitation:"AdUserAcceptInvitation",Ad_User_Minimize:"AdUserMinimize",Ad_User_Close:"AdUserClose",Ad_Paused:"AdPaused",Ad_Playing:"AdPlaying",Ad_Log:"AdLog",Ad_Error:"AdError"},n={NORMAL:"normal",FULL_SCREEN:"fullscreen"},o={APPNEXUS:1,IAS:4,DV:7};t.exports.LOG_LEVEL=i,t.exports.VIEW_EVENT=r,t.exports.VPAID_EVENT=s,t.exports.VIEW_MODE=n,t.exports.MODULE=o},function(t,e,i){var r=i(5).LOG_LEVEL,s={BAD_CONFIG:1,LIBRARY_LOADING_ERROR:2,INITIALIZATION_ERROR:3},n="https://assets.msn.com/staticsb/statics/latest/js/thirdparty/ias/___IASVANS_3.8.9.js",o={origin:"assets.msn.com",path:"/staticsb/statics/latest/js/thirdparty/ias"},a=function(t,e,i,n){"use strict";this.debug=n,this.hasError=!1,this.service=i||{};var o={videoElt:t,params:e,service:i};for(var a in o)o.hasOwnProperty(a)&&(o[a]||(this.hasError=!0,this.log(r.ERROR,"Invalid parameter '"+a+"'='"+o[a]+"'")));if(i){const d=["loggerCallback","getVolumeCallback","getAdDimensionCallback","getAdDurationCallback","getViewModeCallback","errorCallback"];for(var l=0;l<d.length;l++){var u=d[l];if((!i[u]||"function"!=typeof i[u])&&(this.hasError=!0,this.log(r.ERROR,"Service did not implement '"+u+"' API"),"errorCallback"===u))return}}return this.hasError?void this.service.errorCallback(s.BAD_CONFIG,"Invalid parameter"):(this.videoElt=t,this.iasConfig=this.parseParams(e),this.fwVansInstance=null,void(this.iasConfig&&this.iasConfig.hasOwnProperty("advEntityId")&&this.iasConfig.hasOwnProperty("pubEntityId")?(this.init(),this.log(r.DEBUG,"Module initialised")):(this.log(r.ERROR,"Unable to initialise module (missing config)"),this.service.errorCallback(s.BAD_CONFIG,"Unable to initialise module (missing config)"))))};a.prototype={init:function(){"use strict";try{this.loadIasTrackingScript(n,function(){this.fwVansInstance=window.__IASVANS(),this.fwVansInstance.initFW(this.iasConfig,this.videoElt),this.log(r.INFO,"Initialized IAS with config: ",this.iasConfig)}.bind(this))}catch(t){this.log(r.ERROR,"IAS initialization failed"),this.service.errorCallback(s.INITIALIZATION_ERROR,"IAS initialization failed")}},log:function(t,e,i){"use strict";if(this.service.loggerCallback)try{this.service.loggerCallback(t,"[IAS] "+e,i)}catch(r){this.debug&&console.trace(r)}else this.debug&&console.log(t+": "+e,i)},parseParams:function(t){"use strict";this.debug&&this.log(r.DEBUG,"Received params",{params:t});var e={adventityid:"advEntityId",pubentityid:"pubEntityId",ext_app_id:"xmapp",ias_auction:"xsId",partner:"partner",xmtp:"xmtp"};if(t&&"string"==typeof t){var i={},s={},n=t.split(/&/);for(var a in n){var d=n[a].split(/=/),l=d[0].toLowerCase(),u=d[0],h=Object.keys(e);h.indexOf(l)!==-1?"ext_app_id"===l?i[e[l]]=""===d[1]?0:1:i[e[l]]=d[1]:s[u]=d[1]}i.partner="msft",i.xmtp="v";var c=!0,p={};for(var f in e){var g=e[f];this.checkParamExists(g,i)?p[g]=i[g]:(c=!1,this.log(r.ERROR,"Invalid parameter detected '"+g+"'='"+i[g]+"'"))}p.staticConfig={useStatic:!0,origin:o.origin,path:o.path,parameters:'{"config":"/fwjsvid/static.adsafeprotected.com/'+i.advEntityId+"/"+i.pubEntityId+'/skeleton.js?iasProxyPartnerId=2"}'};for(var v in s)p[v]=s[v];if(c)return p}return this.log(r.ERROR,"Invalid parameter received/parsed"),null},checkParamExists:function(t,e){"use strict";return e.hasOwnProperty(t)&&""!==e[t]},notifyVPAIDEvent:function(t){"use strict";if(this.fwVansInstance){this.log(r.INFO,"notifyVPAIDEvent: ["+t+"]");var e=this.service.getAdDimensionCallback(),i={ad_duration:this.service.getAdDurationCallback(),volume:this.service.getVolumeCallback(),viewMode:this.service.getViewModeCallback(),width:e.adWidth,height:e.adHeight};this.fwVansInstance.sendEvent(t,i)}},loadIasTrackingScript:function(t,e){"use strict";try{var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=function(){"function"==typeof e&&e()},i.onerror=function(){this.log(r.DEBUG,"IAS tracking script failed to load"),this.service.errorCallback(s.LIBRARY_LOADING_ERROR,"Can not load IAS script")}.bind(this);var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}catch(o){this.log(r.DEBUG,"IAS tracking script failed to load"),this.service.errorCallback(s.LIBRARY_LOADING_ERROR,"Can not load IAS script")}}},t.exports=a,t.exports.ERROR_CODE=s,t.exports.LOG_LEVEL=r},function(t,e,i){var r=i(5).LOG_LEVEL,s="https://adsdkprod.azureedge.net/assets/dv/v3/msftdvbm.js",n="vpaid_direct_v2",o={BAD_CONFIG:1,LIBRARY_LOADING_ERROR:2,INITIALIZATION_ERROR:3},a=function(t,e,i,s,n){"use strict";this.debug=n,this.hasError=!1,this.service=s||{};var a={videoElement:t,slotElement:e,params:i,service:s};for(var d in a)if(a.hasOwnProperty(d)&&!a[d]&&(this.hasError=!0,this.log(r.ERROR,"Invalid parameter '"+d+"'='"+a[d]+"'"),"service"===d))return void(this.service&&this.service.errorCallback&&this.error(o.BAD_CONFIG,"Invalid parameter"));if(!this.hasError&&s)for(var l=["loggerCallback","getVolumeCallback","errorCallback","subscribe","unsubscribe","getPreviousEvents"],u=0;u<l.length;u++){var h=l[u];if((!s[h]||"function"!=typeof s[h])&&(this.hasError=!0,this.log(r.ERROR,"Service did not implement '"+h+"' API"),"errorCallback"===h))return}return this.hasError?void this.error(o.BAD_CONFIG,"Invalid parameter"):(this.videoElement=t,this.slotElement=e,this.dvConfig=this.parseParams(i),this.previousEvents=[],this.dvInstance=null,void(this.dvConfig?(this.init(),this.log(r.DEBUG,"Module initialized")):(this.log(r.ERROR,"Unable to initialize module (missing config)"),this.error(o.BAD_CONFIG,"Unable to initialize module (missing config)"))))};a.prototype={init:function(){"use strict";try{var t="dvCallback_"+this.generateUUID(),e=this;window[t]=function(){return{getAdVolume:function(){return e.service.getVolumeCallback()},subscribe:function(){return e.service.subscribe.apply(e.service,arguments)},unsubscribe:function(){return e.service.unsubscribe.apply(e.service,arguments)},getPlayer:function(){return e.videoElement},getSlot:function(){return e.slotElement},getPreviousEvents:function(){return e.service.getPreviousEvents.apply(e.service,arguments)}}};var i=this.getScriptParams(t);this.loadDVScript(i)}catch(s){this.log(r.ERROR,"DV initialization failed",s),this.error(o.INITIALIZATION_ERROR,"DV initialization failed")}},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})},getScriptParams:function(t){"use strict";var e=["ctx="+this.dvConfig.ctx,"cmp="+this.dvConfig.cmp,"sid="+this.dvConfig.sid,"crt="+this.dvConfig.crt,"plc="+this.dvConfig.plc,"adsrv="+this.dvConfig.adsrv,"tagformat=2&tagtype=1&dvtagver="+n,"adid="+t];return this.dvConfig.dup&&e.push("dup="+this.dvConfig.dup),e.join("&")},log:function(t,e,i){"use strict";if(this.service.loggerCallback&&"function"==typeof this.service.loggerCallback)try{this.service.loggerCallback(t,"[DV] "+e,i)}catch(r){this.debug&&console.trace(r)}else this.debug&&console.log(t+": "+e,i)},error:function(t,e){"use strict";if(this.service.errorCallback&&"function"==typeof this.service.errorCallback)try{this.service.errorCallback(t,e)}catch(i){this.debug&&console.trace(i)}},parseParams:function(t){"use strict";if(this.debug&&this.log(r.DEBUG,"Received params",{params:t}),t&&"string"==typeof t){var e={},i=t.split(/&/);for(var s in i){var n=i[s].split(/=/);2===n.length&&(e[n[0]]=decodeURIComponent(n[1]))}for(var o=["ctx","cmp","sid","crt","plc","adsrv"],a=!0,d=0;d<o.length;d++)if(!e.hasOwnProperty(o[d])||""===e[o[d]]){a=!1;break}if(a)return e}return this.log(r.ERROR,"Invalid parameter received/parsed"),null},loadDVScript:function(t){"use strict";var e=this;try{var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=s+"?"+t,i.onload=function(){e.log(r.INFO,"DV script loaded successfully")},i.onerror=function(){e.log(r.ERROR,"DV tracking script failed to load"),e.error(o.LIBRARY_LOADING_ERROR,"Can not load DV script")};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(i,n)}catch(a){this.log(r.ERROR,"DV tracking script failed to load",a),this.error(o.LIBRARY_LOADING_ERROR,"Can not load DV script")}}},t.exports=a,t.exports.ERROR_CODE=o,t.exports.LOG_LEVEL=r},function(t,e){for(var i=0,r=1,s=2,n=3,o=4,a={Xml_Parsing_Error:[100,i],Vast_Validation_Error:[101,i],Ad_Type_Error:[200,i],General_Wrapper_Error:[300,i],Missing_Vast_Error:[303,i],General_Linear_Error:[400,i],Media_File_Mime_Type_Error:[403,i],Media_File_Display_Error:[405,i],Init_Ad:[1200,n],Missing_AdParameters_Error:[1211,i],Json_Parsing_Error:[1212,i],Json_Empty_Error:[1213,i],No_Ads_Error:[1214,i],Missing_Vast_Config_Error:[1215,i],Vast_Parser_Error:[1220,i],Core_Js_Error:[1300,r],Missing_View_Config_Error:[1302,r],Viewability_Element_Error:[1303,r],Fake_VideoSlot_Element_Error:[1304,s],Fake_Slot_Element_Error:[1305,s],Ias_Error:[1320,r],Ias_Config_Error:[1321,r],Ias_Loading_Error:[1322,r],Dv_Error:[1330,r],Dv_Config_Error:[1331,r],Dv_Loading_Error:[1332,r],ClickThru_Error:[1500,r],Url_Sending_Error:[1501,s],Pixel_Sending_Error:[1502,s],Icon_ClickThru_Error:[1505,r],Proxy_HTML5_Not_Loaded:[1600,i],Proxy_Script_Loading_Error:[1601,i],JS_Loading_Interface_Error:[1610,i],JS_Starting_Interface_Error:[1620,i],JS_Playing_Interface_Error:[1630,r],Video_Load_Error:[1802,i],Video_Volume_Error:[1803,r],Video_Play_Error:[1804,i],Video_Pause_Error:[1805,r],Video_Remove_Event_Error:[1806,r],Video_Metadata_Error:[1807,i],Video_Timing_Error:[1808,r],Video_Tag_Loading_Default_Error:[1810,i],Video_Tag_Loading_Abort_Error:[1811,i],Video_Tag_Stalled_Error:[1812,s],Video_Network_Error:[1813,s],Video_Src_Not_Supported_Error:[1814,i],Video_Tag_Starting_Default_Error:[1820,i],Video_Tag_Starting_Abort_Error:[1821,i],Video_Tag_Playing_Default_Error:[1830,i],Video_Tag_Playing_Abort_Error:[1831,i],Video_Network_Error_While_Playing:[1833,s],Video_Src_Not_Supported_Error_While_Playing:[1834,s],Media_File_Display_Error_While_Playing:[1835,s],Vast_OMID_AdVerifications_Node_Present:[1900,o],Vast_OMID_Extensions_AdVerifications_Node_Present:[1901,o],Vast_OMID_AdVerification_APIFramework_Not_OMID:[1902,o],Multiple_Vast_Ads:[1910,o],WhiteOps_Dropped:[1911,o],External_Loading_Error:[2300,i],External_Starting_Error:[2400,i],External_Playing_Error:[2500,i],External_Dispose_Error:[2600,i]},d=Object.keys(a),l=0;l<d.length;l++){var u=a[d[l]];a[d[l]]=function(t){return function(e){return{code:t[0],severity:t[1],message:e||""}}}(a[d[l]]),a[d[l]].code=u[0],a[d[l]].severity=u[1]}t.exports=a,t.exports.SEVERITY={FATAL:i,ERROR:r,WARN:s,INFO:n,DEBUG:o},t.exports.equals=function(t,e){return t&&e&&t.code===e.code}},function(t,e,i){var r=i(10),s=function(t,e){"use strict";if(this.name={"package":t,module:e},this.level={debug:!1,info:!1,warn:!1,error:!1,fatal:!1},this.levelNames={debug:"debug",info:"info",warn:"warn",error:"error",fatal:"fatal",none:"none"},this.logLevel=r.getANWrapperParameter("wrapperLogLevel")||this.levelNames.none,this.logLevel!==this.levelNames.none)switch(this.levelNames.hasOwnProperty(this.logLevel)||(this.logLevel=this.levelNames.none),this.logLevel){case this.levelNames.debug:this.level.debug=!0;case this.levelNames.info:this.level.info=!0;case this.levelNames.warn:this.level.warn=!0;case this.levelNames.error:this.level.error=!0;case this.levelNames.fatal:this.level.fatal=!0}};s.prototype={debug:function(t,e){this.level.debug&&this.log(this.levelNames.debug,Date.now(),t,e||{})},info:function(t,e){this.level.info&&this.log(this.levelNames.info,Date.now(),t,e||{})},warn:function(t,e){this.level.warn&&this.log(this.levelNames.warn,Date.now(),t,e||{})},error:function(t,e){this.level.error&&this.log(this.levelNames.error,Date.now(),t,e||{})},fatal:function(t,e){this.level.fatal&&this.log(this.levelNames.fatal,Date.now(),t,e||{})},log:function(t,e,i,r){try{"undefined"!=typeof window&&window&&window.top?window.top.postMessage(JSON.stringify({origin:"devnxs",id:e,loggerName:this.name["package"],loggerShortName:this.name.module,level:t,message:i,parameters:r,time:e},function(t,e){if(void 0===e)return"undefined";if(e&&"object"==typeof e){if("number"==typeof e.nodeType&&"string"==typeof e.nodeName)return{type:e.nodeName,id:e.id};if("undefined"!=typeof e.duration&&"undefined"!=typeof e.ended&&"undefined"!=typeof e.paused&&"undefined"!=typeof e.playbackRate&&"undefined"!=typeof e.src&&"function"==typeof e.canPlayType)return{type:"fakeHTMLVideolement",id:e.id||void 0}}return e}),"*"):console.error("Unable to postMessage (window[.top] no longer available. Message: ["+this.name.module+"] "+i)}catch(s){console.error("Error during postMessage:"+s)}}},s.createLogger=function(t,e){return new s(t,e)},t.exports=s},function(t,e){t.exports={getANWrapperParameter:function(t){var e=null;try{for(var i=document.getElementsByTagName("script"),r=0;r<i.length;r++)i[r].src.indexOf("anwrapper")!==-1&&i[r].src.split("?")[1].split("&").forEach(function(i){var r=i.split("=");r[0]==t&&(e=r[1])},this)}catch(s){}return e},getNestedProperty:function(t,e){return e.split(".").reduce(function(t,e){return t&&t[e]},t)}}},function(t,e,i){var r=i(12),s=i(13),n=i(9).createLogger("js.vpaidEvent.VPAIDEvent","VPAIDEvent"),o=function(){"use strict";this.tagLabel="an_context_tag",this.tagWord="an_tag_",this.tagCount=0,this.dispatchedEvents=[],this.events={Ad_Loaded:[],Ad_Started:[],Ad_Stopped:[],Ad_Skipped:[],Ad_Skippable_State_Change:[],Ad_Size_Change:[],Ad_Linear_Change:[],Ad_Duration_Change:[],Ad_Expanded_Change:[],Ad_Remaining_Time_Change:[],Ad_Volume_Change:[],Ad_Impression:[],Ad_Video_Start:[],Ad_Video_First_Quartile:[],Ad_Video_Midpoint:[],Ad_Video_Third_Quartile:[],Ad_Video_Complete:[],Ad_Click_Thru:[],Ad_Interaction:[],Ad_User_Accept_Invitation:[],Ad_User_Minimize:[],Ad_User_Close:[],Ad_Paused:[],Ad_Playing:[],Ad_Log:[],Ad_Error:[]},this.onlyOnce={Ad_Loaded:!1,Ad_Started:!1,Ad_Stopped:!1,Ad_Skipped:!1,Ad_Skippable_State_Change:!1,Ad_Linear_Change:!1,Ad_Impression:!1,Ad_Video_Start:!1,Ad_Video_First_Quartile:!1,Ad_Video_Midpoint:!1,Ad_Video_Third_Quartile:!1,Ad_Video_Complete:!1,Ad_Click_Thru:!1,Ad_User_Close:!1,Ad_Error:!1}};o.prototype={subscribe:function(t,e,i){"use strict";if("function"!=typeof t||"string"!=typeof e)return void n.warn("subscribe",{message:"unsupported arguments type"});if("object"!=typeof i&&null!==i&&void 0!==i)return void n.warn("subscribe",{message:"cannot register : bad context for "+e});var r=s.toEventNameSyntax(e);if(r in this.events){this.tagContext(i);var o=this.findContext(i,t,this.events[r]),a={context:i||null,callback:t};o===!1?this.events[r].push(a):n.warn("Event "+e+" already set for this context")}else n.warn("subscribe",{message:"unknown eventName : "+e})},unsubscribe:function(t,e,i){"use strict";if("function"!=typeof t||"string"!=typeof e)return void n.warn("unsubscribe",{message:"unsupported arguments type"});var r=s.toEventNameSyntax(e);if(r in this.events){var o=this.findContext(i,t,this.events[r]);o!==!1?this.events[r].splice(o,1):n.warn("Event "+e+" already removed or not set for this context, or unknown context")}else n.warn("unsubscribe",{message:"unknown eventName : "+e})},tagContext:function(t){"use strict";t&&!t.hasOwnProperty(this.tagLabel)&&(t[this.tagLabel]=this.tagWord+this.tagCount,this.tagCount++)},findContext:function(t,e,i){"use strict";if(null!==i&&"object"==typeof i&&i.length>=0&&"function"==typeof e)for(var r=t&&t.hasOwnProperty(this.tagLabel),s=0;s<i.length;s++)if(i[s].callback.toString()===e.toString())if(r){if(i[s].context&&i[s].context[this.tagLabel]===t[this.tagLabel])return s}else if(!i[s].context)return s;return!1},sendEvent:function(t,e,i,o){"use strict";var a=s.toEventNameSyntax(t);if(this.dispatchedEvents.push(a),a in this.onlyOnce&&(this.onlyOnce[a]=!0),a in this.events&&0!==this.events[a].length){switch(t!=r.Ad_Remaining_Time_Change&&n.info("sendEvent",{event:t}),t){case r.Ad_Click_Thru:this.events[a].forEach(function(t){setTimeout(function(){t.callback.call(t.context,e,i,o)},0)});break;case r.Ad_Interaction:this.events[a].forEach(function(t){setTimeout(function(){t.callback.call(t.context,e)},0)});break;case r.Ad_Log:this.events[a].forEach(function(t){setTimeout(function(){t.callback.call(t.context,e)},0)});break;case r.Ad_Error:this.events[a].forEach(function(t){setTimeout(function(){t.callback.call(t.context,e,i)},0)});break;default:this.events[a].forEach(function(t){setTimeout(function(){t.callback.call(t.context)},0)})}return!0}return t!=r.Ad_Remaining_Time_Change&&n.debug("sendEvent",{notSubscribe:t}),!1},alreadySent:function(t){"use strict";var e=s.toEventNameSyntax(t);return e in this.onlyOnce&&this.onlyOnce[e]},getPreviousEvents:function(){"use strict";var t=this.dispatchedEvents.map(function(t){return t.replace(/Ad_(.+)/g,"Ad$1").replace(/_/g,"")});return n.info("getPreviousEvents",{events:t}),t}},t.exports=o},function(t,e){t.exports={Ad_Loaded:"AdLoaded",Ad_Started:"AdStarted",Ad_Stopped:"AdStopped",Ad_Skipped:"AdSkipped",Ad_Skippable_State_Change:"AdSkippableStateChange",Ad_Size_Change:"AdSizeChange",Ad_Linear_Change:"AdLinearChange",Ad_Duration_Change:"AdDurationChange",Ad_Expanded_Change:"AdExpandedChange",Ad_Remaining_Time_Change:"AdRemainingTimeChange",Ad_Volume_Change:"AdVolumeChange",Ad_Impression:"AdImpression",Ad_Video_Start:"AdVideoStart",Ad_Video_First_Quartile:"AdVideoFirstQuartile",Ad_Video_Midpoint:"AdVideoMidpoint",Ad_Video_Third_Quartile:"AdVideoThirdQuartile",Ad_Video_Complete:"AdVideoComplete",Ad_Click_Thru:"AdClickThru",Ad_Interaction:"AdInteraction",Ad_User_Accept_Invitation:"AdUserAcceptInvitation",Ad_User_Minimize:"AdUserMinimize",Ad_User_Close:"AdUserClose",Ad_Paused:"AdPaused",Ad_Playing:"AdPlaying",Ad_Log:"AdLog",Ad_Error:"AdError"}},function(t,e){t.exports={toEventNameSyntax:function(t){"use strict";return!("string"!=typeof t||!t.match(/^([A-Z][a-z]+)+$/g))&&t.replace(/([a-z])([A-Z])/g,"$1_$2")},validateAdClickThruData:function(t,e,i){"use strict";return"string"!=typeof t||0!==t.indexOf("http")&&0!==t.indexOf("//")&&""!==t?["","",!1]:"boolean"==typeof i?"string"==typeof e?[t,e,i]:[t,"",i]:[t,"",!1]},validateAdInteractionData:function(t){"use strict";return"string"==typeof t?t:""},validateAdLogData:function(t,e){"use strict";return"string"==typeof t?t:"string"==typeof e?e:""},validateAdErrorData:function(t,e){"use strict";if("number"==typeof e&&"string"==typeof t)return[t,e];if("number"==typeof t&&"string"==typeof e){var i=e;return e=t,[i,e]}return"number"==typeof e?["",e]:"number"==typeof t?["",t]:"string"==typeof t&&t.match(/\d+/)?(e=parseInt(t.match(/\d+/)[0]),[t,e]):"string"==typeof e&&e.match(/\d+/)?(t=e,e=parseInt(t.match(/\d+/)[0]),[t,e]):["",900]}}},function(t,e,i){var r=i(15),s=i(12),n=i(21),o=function(t){"use strict";this.urls={},this.pendingPixelsCount=0,this.disposeDelay=50,this.disposeTimeout=null,this.onlyOnce={creativeView:!1,start:!1,firstQuartile:!1,midpoint:!1,thirdQuartile:!1,complete:!1,skip:!1,error:!1,impression:!1},this.urlSender=new r(this.callback.bind(this)),this.errorCallback=t};o.prototype={addTrackingEvent:function(t,e){"use strict";t in this.urls?this.urls[t]=this.urls[t].concat(e):this.urls[t]=e},addTrackingEvents:function(t){"use strict";var e=Object.keys(t);for(var i in e)this.addTrackingEvent(e[i],t[e[i]])},notifyTrackingEvent:function(t,e){"use strict";var i=[];switch(t){case s.Ad_Started:i.push("creativeView");break;case s.Ad_Skipped:i.push("skip");break;case s.Ad_Impression:i.push("impression");break;case s.Ad_Video_Start:
i.push("start");break;case s.Ad_Video_First_Quartile:i.push("firstQuartile");break;case s.Ad_Video_Midpoint:i.push("midpoint");break;case s.Ad_Video_Third_Quartile:i.push("thirdQuartile");break;case s.Ad_Video_Complete:i.push("complete");break;case s.Ad_Click_Thru:i.push("clickTracking");break;case s.Ad_User_Accept_Invitation:i.push("acceptInvitationLinear");break;case s.Ad_User_Close:i.push("closeLinear");break;case s.Ad_Paused:i.push("pause");break;case s.Ad_Playing:i.push("resume");break;case s.Ad_Error:i.push("error");break;case"Mute":i.push("mute");break;case"Unmute":i.push("unmute");break;case"Rewind":i.push("rewind");break;case"Expand":i.push("expand"),i.push("fullscreen");break;case"Collapse":i.push("collapse"),i.push("exitFullscreen")}for(var r in i){var o=!1;if(i[r]in this.onlyOnce&&!this.onlyOnce[i[r]]?(this.onlyOnce[i[r]]=!0,o=!0):i[r]in this.onlyOnce||(o=!0),o)for(var a in this.urls[i[r]]){var d=this.urls[i[r]][a];d=n.replaceMacro(d,e),this.send(d)}}},send:function(t){"use strict";"about:blank"!=t&&(this.pendingPixelsCount++,this.urlSender.send(t))},callback:function(t){"use strict";this.pendingPixelsCount--,null!==t&&this.errorCallback(t)},dispose:function(t){"use strict";return 0==this.pendingPixelsCount?void(t.disposeFlags.trackingManager=!0):void(this.disposeTimeout=setInterval(function(){0==this.pendingPixelsCount&&(t.disposeFlags.trackingManager=!0,clearInterval(this.disposeTimeout))}.bind(this),this.disposeDelay))}},t.exports=o},function(t,e,i){var r=i(16),s=i(8),n=i(9).createLogger("js.utils.UrlRequestUtils","UrlRequestUtils"),o=function(t,e,i){"use strict";this.sendingStatus=!1,this.sendingTimeout=5e3,this.gettingTimeout=1e4,this.retried=!1,this.url="",this.xhrCredentials=!!i,this.validStatus=[200,204],this.responseCallback=t,this.debugCallback=e||function(){}};o.prototype={send:function(t){"use strict";try{this.sendPixel(t)}catch(e){this.responseCallback(s.Url_Sending_Error())}},sendBeacon:function(t){"use strict";return!!navigator.sendBeacon&&navigator.sendBeacon(t)},sendXHR:function(t){"use strict";this.sendingStatus=!0,r.get({url:t,timeout:this.sendingTimeout},this.sendXHRCallback.bind(this,t))},sendXHRCallback:function(t,e,i,r){"use strict";this.sendingStatus=!1,e?(n.error("xhrCallback",{error:e.message}),this.sendPixel(t)):this.validStatus.indexOf(i.statusCode)==-1?(n.error("xhrCallback",{http_status:i.statusCode}),this.sendPixel(t)):(n.debug("send",{msg:"send via xhr"}),this.responseCallback(0))},sendPixel:function(t){"use strict";n.debug("send",{msg:"send via pixel"});try{var e=document.createElement("img");e.style.width="1px",e.style.height="1px",e.onload=function(){this.responseCallback(null)}.bind(this),e.onerror=function(){this.responseCallback(null)}.bind(this),e.src=t,document.body.appendChild(e)}catch(i){this.responseCallback(s.Pixel_Sending_Error())}},getXHR:function(t){"use strict";this.url=t;var e=!1;if("string"==typeof t&&""!==t){var i=t.match(/.*?:\/\/(.*?)\/.*/);i&&i[1]&&(e=i[1].indexOf("adnxs.com")!==-1)}this.xhrCredentials=e||this.xhrCredentials,this.retried&&(this.xhrCredentials=!1),this.sendingStatus=!0,r.get({url:t,timeout:this.gettingTimeout,withCredentials:this.xhrCredentials},this.getXHRCallback.bind(this))},getXHRCallback:function(t,e,i){"use strict";this.sendingStatus=!1,t||this.validStatus.indexOf(e.statusCode)==-1?(n.error("getXHRCallback",{xhrError:!!t,http_status:e.statusCode}),!this.retried&&this.xhrCredentials?(n.warn("getXHRCallback",{message:"credential retry"}),this.retried=!0,this.getXHR(this.url)):this.responseCallback(s.Missing_Vast_Error())):this.responseCallback(null,i)}},t.exports=o},function(t,e,i){"use strict";function r(t,e){for(var i=0;i<t.length;i++)e(t[i])}function s(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function n(t,e,i){var r=t;return h(e)?(i=e,"string"==typeof t&&(r={uri:t})):r=p(e,{uri:t}),r.callback=i,r}function o(t,e,i){return e=n(t,e,i),a(e)}function a(t){function e(){4===u.readyState&&setTimeout(n,0)}function i(){var t=void 0;if(t=u.response?u.response:u.responseText||d(u),y)try{t=JSON.parse(t)}catch(e){}return t}function r(t){return clearTimeout(f),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,l(t,w)}function n(){if(!p){var e;clearTimeout(f),e=t.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var r=w,s=null;return 0!==e?(r={body:i(),statusCode:e,method:v,headers:{},url:g,rawRequest:u},u.getAllResponseHeaders&&(r.headers=c(u.getAllResponseHeaders()))):s=new Error("Internal XMLHttpRequest Error"),l(s,r,r.body)}}if("undefined"==typeof t.callback)throw new Error("callback argument missing");var a=!1,l=function(e,i,r){a||(a=!0,t.callback(e,i,r))},u=t.xhr||null;u||(u=t.cors||t.useXDR?new o.XDomainRequest:new o.XMLHttpRequest);var h,p,f,g=u.url=t.uri||t.url,v=u.method=t.method||"GET",m=t.body||t.data,_=u.headers=t.headers||{},b=!!t.sync,y=!1,w={body:void 0,headers:{},statusCode:0,method:v,url:g,rawRequest:u};if("json"in t&&t.json!==!1&&(y=!0,_.accept||_.Accept||(_.Accept="application/json"),"GET"!==v&&"HEAD"!==v&&(_["content-type"]||_["Content-Type"]||(_["Content-Type"]="application/json"),m=JSON.stringify(t.json===!0?m:t.json))),u.onreadystatechange=e,u.onload=n,u.onerror=r,u.onprogress=function(){},u.onabort=function(){p=!0},u.ontimeout=r,u.open(v,g,!b,t.username,t.password),b||(u.withCredentials=!!t.withCredentials),!b&&t.timeout>0&&(f=setTimeout(function(){if(!p){p=!0,u.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",r(t)}},t.timeout)),u.setRequestHeader)for(h in _)_.hasOwnProperty(h)&&u.setRequestHeader(h,_[h]);else if(t.headers&&!s(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(u.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(u),u.send(m||null),u}function d(t){try{if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;if(""===t.responseType&&!e)return t.responseXML}catch(i){}return null}function l(){}var u=i(17),h=i(18),c=i(19),p=i(20);t.exports=o,t.exports["default"]=o,o.XMLHttpRequest=u.XMLHttpRequest||l,o.XDomainRequest="withCredentials"in new o.XMLHttpRequest?o.XMLHttpRequest:u.XDomainRequest,r(["get","put","post","patch","head","delete"],function(t){o["delete"===t?"del":t]=function(e,i,r){return i=n(e,i,r),i.method=t.toUpperCase(),a(i)}})},function(t,e){(function(e){var i;i="undefined"!=typeof window?window:"undefined"!=typeof e?e:"undefined"!=typeof self?self:{},t.exports=i}).call(e,function(){return this}())},function(t,e){function i(t){if(!t)return!1;var e=r.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}t.exports=i;var r=Object.prototype.toString},function(t,e){var i=function(t){return t.replace(/^\s+|\s+$/g,"")},r=function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=function(t){if(!t)return{};for(var e={},s=i(t).split("\n"),n=0;n<s.length;n++){var o=s[n],a=o.indexOf(":"),d=i(o.slice(0,a)).toLowerCase(),l=i(o.slice(a+1));"undefined"==typeof e[d]?e[d]=l:r(e[d])?e[d].push(l):e[d]=[e[d],l]}return e}},function(t,e){function i(){for(var t={},e=0;e<arguments.length;e++){var i=arguments[e];for(var s in i)r.call(i,s)&&(t[s]=i[s])}return t}t.exports=i;var r=Object.prototype.hasOwnProperty},function(t,e){t.exports={macroConst:{error:"[ERRORCODE]",contentPlayHead:"[CONTENTPLAYHEAD]",cacheBusting:"[CACHEBUSTING]",assetUri:"[ASSETURI]",timestamp:"[TIMESTAMP]",correlator:"[timestamp]"},replaceMacro:function(t,e,i,r){"use strict";return e&&(t=this.replaceError(t,e)),i&&(t=this.replaceContentPlayHead(t,i)),r&&(t=this.replaceAssetUri(t,r)),t=this.replaceTimeStamp(t)},replaceError:function(t,e){"use strict";return t.search(this.macroConst.error)>-1&&"number"==typeof e?t.replace(this.macroConst.error,e):t},replaceContentPlayHead:function(t,e){"use strict";return t.search(this.macroConst.contentPlayHead)>-1&&e&&"string"==typeof e&&e.match(/\d{2,}:\d{2,}:\d{2,}\.\d{3}/)?t.replace(this.macroConst.contentPlayHead,encodeURIComponent(e)):t},replaceTimeStamp:function(t){"use strict";return t.search(this.macroConst.cacheBusting)>-1&&(t=t.replace(this.macroConst.cacheBusting,String(Date.now()).substr(-8))),t.search(this.macroConst.timestamp)>-1&&(t=t.replace(this.macroConst.timestamp,encodeURIComponent((new Date).toISOString()))),t.search(this.macroConst.correlator)>-1&&(t=t.replace(this.macroConst.correlator,String(Date.now()))),t},replaceAssetUri:function(t,e){"use strict";return t.search(this.macroConst.assetUri)>-1&&e&&"string"==typeof e?t.replace(this.macroConst.assetUri,encodeURIComponent(e)):t}}},function(t,e,i){var r=i(23).Base64,s=i(8),n=i(9).createLogger("js.utils.WrapperParametersUtils","WrapperParametersUtils"),o=function(t){"use strict";this.vast=null,this.viewabilityConfiguration=null,this.internalLogConfig=null,this.dropUsersync=!0,this.usersyncUrl="",this.whiteOpsUrl="",this.xhrCookieCredentials=!1,this.skipEnabled=!1,this.overrideBitrate=!1,this.hasError=null,this.internalParameters={},this.parseParameters(t)};o.prototype={parseParameters:function(t){"use strict";if(!t||"object"!=typeof t||!t.hasOwnProperty("AdParameters")||"string"!=typeof t.AdParameters)return void(this.hasError=s.Missing_AdParameters_Error());var e=String(t.AdParameters).replace(/^(\s+)/g,""),i=null;try{i=JSON.parse(e)}catch(o){return n.error("Failed parsing json content",o),void(this.hasError=s.Json_Parsing_Error())}if(null===i)return void(this.hasError=s.Json_Empty_Error());var a="",d={};if(!i.hasOwnProperty("ads"))return void(this.hasError=s.No_Ads_Error());for(var l in i.ads){var u=i.ads[l];if(u.hasOwnProperty("content_source")&&"rtb"===u.content_source){if(u.hasOwnProperty("rtb")&&(u.rtb.hasOwnProperty("content_b64")&&""!==u.rtb.content_b64&&(this.vast=r.decode(u.rtb.content_b64)),u.rtb.hasOwnProperty("video")&&u.rtb.video.hasOwnProperty("content_b64")&&""!==u.rtb.video.content_b64&&(this.vast=r.decode(u.rtb.video.content_b64))),u.hasOwnProperty("viewability")){if(u.viewability.hasOwnProperty("config")){var h=u.viewability.config.match(/^(.*&)?(tv=[^&]*)/);null!==h&&(u.viewability.config=u.viewability.config.replace(h[2],h[2]+"-anwrapper"))}this.viewabilityConfiguration=u.viewability,u.viewability.hasOwnProperty("config")&&""!==u.viewability.config&&(d=this.parseConfigs(u.viewability.config))}u.hasOwnProperty("buyer_member_id")&&""!==u.buyer_member_id&&(a=u.buyer_member_id),u.hasOwnProperty("usersync_url")&&""!==u.usersync_url&&(this.usersyncUrl=decodeURIComponent(u.usersync_url)),u.hasOwnProperty("whiteops_fraud_sensor_js_url")&&""!==u.whiteops_fraud_sensor_js_url&&(this.whiteOpsUrl=decodeURIComponent(u.whiteops_fraud_sensor_js_url))}}if(this.internalParameters=d,d.hasOwnProperty("vc")){var c=d.vc.split(/;/),p=[],f=!1;for(var g in c){if("vid_nous"==c[g]&&(this.dropUsersync=!1),c[g].indexOf("vid_ccr")!=-1){var v=c[g].split(/=/);p.push(parseInt(v[1]))}if(c[g].indexOf("vid_skip")!=-1&&!f){var m=c[g].split(/=/);"0"!=m[1]?this.skipEnabled=!0:(f=!0,this.skipEnabled=!1)}"vid_espn"==c[g]&&(this.overrideBitrate=!0)}if(0!==p.length){this.xhrCookieCredentials=!0;for(var _=0;_<p.length;_++)this.xhrCookieCredentials=this.xhrCookieCredentials&&!!p[_]}}d.hasOwnProperty("rblog")&&(this.internalLogConfig=d.rblog,""!==a&&this.internalLogConfig.indexOf("bm=")==-1&&(this.internalLogConfig+=";bm="+a))},parseConfigs:function(t){"use strict";if(t&&"string"==typeof t){var e={},i=t.split(/&/);for(var r in i){var s=i[r].split(/=/);if(2==s.length)e[s[0]]=decodeURIComponent(s[1]);else if(s.length>2){for(var n="",o=1;o<s.length;o++)n+="="+s[o];e[s[0]]=decodeURIComponent(n.substr(1))}else e[s[0]]=""}if(e!=={})return e}return{}}},t.exports=o},function(t,e,i){(function(e,i){!function(e,i){t.exports=i()}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof e?e:this,function(){"use strict";var t="3.7.2",e=t,r="function"==typeof atob,s="function"==typeof btoa,n="function"==typeof i,o="function"==typeof TextDecoder?new TextDecoder:void 0,a="function"==typeof TextEncoder?new TextEncoder:void 0,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=Array.prototype.slice.call(d),u=function(t){var e={};return t.forEach(function(t,i){return e[t]=i}),e}(l),h=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,c=String.fromCharCode.bind(String),p="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(t,e){return void 0===e&&(e=function(t){return t}),new Uint8Array(Array.prototype.slice.call(t,0).map(e))},f=function(t){return t.replace(/=/g,"").replace(/[+\/]/g,function(t){return"+"==t?"-":"_"})},g=function(t){return t.replace(/[^A-Za-z0-9\+\/]/g,"")},v=function(t){for(var e,i,r,s,n="",o=t.length%3,a=0;a<t.length;){if((i=t.charCodeAt(a++))>255||(r=t.charCodeAt(a++))>255||(s=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=i<<16|r<<8|s,n+=l[e>>18&63]+l[e>>12&63]+l[e>>6&63]+l[63&e]}return o?n.slice(0,o-3)+"===".substring(o):n},m=s?function(t){return btoa(t)}:n?function(t){return i.from(t,"binary").toString("base64")}:v,_=n?function(t){return i.from(t).toString("base64")}:function(t){for(var e=4096,i=[],r=0,s=t.length;r<s;r+=e)i.push(c.apply(null,t.subarray(r,r+e)));return m(i.join(""))},b=function(t,e){return void 0===e&&(e=!1),e?f(_(t)):_(t)},y=function(t){if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?c(192|e>>>6)+c(128|63&e):c(224|e>>>12&15)+c(128|e>>>6&63)+c(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return c(240|e>>>18&7)+c(128|e>>>12&63)+c(128|e>>>6&63)+c(128|63&e)},w=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,A=function(t){return t.replace(w,y)},E=n?function(t){return i.from(t,"utf8").toString("base64")}:a?function(t){return _(a.encode(t))}:function(t){return m(A(t))},S=function(t,e){return void 0===e&&(e=!1),e?f(E(t)):E(t)},k=function(t){return S(t,!0)},C=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,I=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),i=e-65536;return c((i>>>10)+55296)+c((1023&i)+56320);case 3:return c((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return c((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},T=function(t){return t.replace(C,I)},x=function(t){if(t=t.replace(/\s+/g,""),!h.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));for(var e,i,r,s="",n=0;n<t.length;)e=u[t.charAt(n++)]<<18|u[t.charAt(n++)]<<12|(i=u[t.charAt(n++)])<<6|(r=u[t.charAt(n++)]),s+=64===i?c(e>>16&255):64===r?c(e>>16&255,e>>8&255):c(e>>16&255,e>>8&255,255&e);return s},N=r?function(t){return atob(g(t))}:n?function(t){return i.from(t,"base64").toString("binary")}:x,R=n?function(t){return p(i.from(t,"base64"))}:function(t){return p(N(t),function(t){return t.charCodeAt(0)})},V=function(t){return R(D(t))},P=n?function(t){return i.from(t,"base64").toString("utf8")}:o?function(t){return o.decode(R(t))}:function(t){return T(N(t))},D=function(t){return g(t.replace(/[-_]/g,function(t){return"-"==t?"+":"/"}))},M=function(t){return P(D(t))},O=function(t){if("string"!=typeof t)return!1;var e=t.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+\/]/.test(e)||!/[^\s0-9a-zA-Z\-_]/.test(e)},L=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}},U=function(){var t=function(t,e){return Object.defineProperty(String.prototype,t,L(e))};t("fromBase64",function(){return M(this)}),t("toBase64",function(t){return S(this,t)}),t("toBase64URI",function(){return S(this,!0)}),t("toBase64URL",function(){return S(this,!0)}),t("toUint8Array",function(){return V(this)})},B=function(){var t=function(t,e){return Object.defineProperty(Uint8Array.prototype,t,L(e))};t("toBase64",function(t){return b(this,t)}),t("toBase64URI",function(){return b(this,!0)}),t("toBase64URL",function(){return b(this,!0)})},F=function(){U(),B()},j={version:t,VERSION:e,atob:N,atobPolyfill:x,btoa:m,btoaPolyfill:v,fromBase64:M,toBase64:S,encode:S,encodeURI:k,encodeURL:k,utob:A,btou:T,decode:M,isValid:O,fromUint8Array:b,toUint8Array:V,extendString:U,extendUint8Array:B,extendBuiltins:F};return j.Base64={},Object.keys(j).forEach(function(t){return j.Base64[t]=j[t]}),j})}).call(e,function(){return this}(),i(24).Buffer)},function(t,e,i){(function(t){"use strict";function r(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}function s(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function n(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=o.prototype):(null===t&&(t=new o(e)),t.length=e),t}function o(t,e,i){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return a(this,t,e,i)}function a(t,e,i,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?p(t,e,i,r):"string"==typeof e?h(t,e,i):f(t,e)}function d(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e,i,r){return d(e),e<=0?n(t,e):void 0!==i?"string"==typeof r?n(t,e).fill(i,r):n(t,e).fill(i):n(t,e)}function u(t,e){if(d(e),t=n(t,e<0?0:0|g(e)),!o.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function h(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!o.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var r=0|m(e,i);t=n(t,r);var s=t.write(e,i);return s!==r&&(t=t.slice(0,s)),t}function c(t,e){var i=e.length<0?0:0|g(e.length);t=n(t,i);for(var r=0;r<i;r+=1)t[r]=255&e[r];return t}function p(t,e,i,r){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,i):new Uint8Array(e,i,r),o.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=o.prototype):t=c(t,e),t}function f(t,e){if(o.isBuffer(e)){var i=0|g(e.length);return t=n(t,i),0===t.length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||Z(e.length)?n(t,0):c(t,e);if("Buffer"===e.type&&$(e.data))return c(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function g(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function v(t){return+t!=t&&(t=0),o.alloc(+t)}function m(t,e){if(o.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return J(t).length;default:if(r)return Y(t).length;e=(""+e).toLowerCase(),r=!0}}function _(t,e,i){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if(i>>>=0,e>>>=0,i<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return P(this,e,i);case"utf8":case"utf-8":return x(this,e,i);case"ascii":return R(this,e,i);case"latin1":case"binary":return V(this,e,i);case"base64":return T(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,i);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function b(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function y(t,e,i,r,s){if(0===t.length)return-1;if("string"==typeof i?(r=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=s?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(s)return-1;i=t.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof e&&(e=o.from(e,r)),o.isBuffer(e))return 0===e.length?-1:w(t,e,i,r,s);if("number"==typeof e)return e=255&e,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):w(t,[e],i,r,s);throw new TypeError("val must be string, number or Buffer")}function w(t,e,i,r,s){function n(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,a=t.length,d=e.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,a/=2,d/=2,i/=2}var l;if(s){var u=-1;for(l=i;l<a;l++)if(n(t,l)===n(e,u===-1?0:l-u)){if(u===-1&&(u=l),l-u+1===d)return u*o}else u!==-1&&(l-=l-u),u=-1}else for(i+d>a&&(i=a-d),l=i;l>=0;l--){for(var h=!0,c=0;c<d;c++)if(n(t,l+c)!==n(e,c)){h=!1;break}if(h)return l}return-1}function A(t,e,i,r){i=Number(i)||0;var s=t.length-i;r?(r=Number(r),r>s&&(r=s)):r=s;var n=e.length;if(n%2!==0)throw new TypeError("Invalid hex string");r>n/2&&(r=n/2);for(var o=0;o<r;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[i+o]=a}return o}function E(t,e,i,r){return q(Y(e,t.length-i),t,i,r)}function S(t,e,i,r){return q(X(e),t,i,r)}function k(t,e,i,r){return S(t,e,i,r)}function C(t,e,i,r){return q(J(e),t,i,r)}function I(t,e,i,r){return q(G(e,t.length-i),t,i,r)}function T(t,e,i){return 0===e&&i===t.length?K.fromByteArray(t):K.fromByteArray(t.slice(e,i))}function x(t,e,i){i=Math.min(t.length,i);for(var r=[],s=e;s<i;){var n=t[s],o=null,a=n>239?4:n>223?3:n>191?2:1;if(s+a<=i){var d,l,u,h;switch(a){case 1:n<128&&(o=n);break;case 2:d=t[s+1],128===(192&d)&&(h=(31&n)<<6|63&d,h>127&&(o=h));break;case 3:d=t[s+1],l=t[s+2],128===(192&d)&&128===(192&l)&&(h=(15&n)<<12|(63&d)<<6|63&l,h>2047&&(h<55296||h>57343)&&(o=h));break;case 4:d=t[s+1],l=t[s+2],u=t[s+3],128===(192&d)&&128===(192&l)&&128===(192&u)&&(h=(15&n)<<18|(63&d)<<12|(63&l)<<6|63&u,h>65535&&h<1114112&&(o=h))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),s+=a}return N(r)}function N(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var i="",r=0;r<e;)i+=String.fromCharCode.apply(String,t.slice(r,r+=tt));return i}function R(t,e,i){var r="";i=Math.min(t.length,i);for(var s=e;s<i;++s)r+=String.fromCharCode(127&t[s]);return r}function V(t,e,i){var r="";i=Math.min(t.length,i);for(var s=e;s<i;++s)r+=String.fromCharCode(t[s]);return r}function P(t,e,i){var r=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>r)&&(i=r);for(var s="",n=e;n<i;++n)s+=z(t[n]);return s}function D(t,e,i){for(var r=t.slice(e,i),s="",n=0;n<r.length;n+=2)s+=String.fromCharCode(r[n]+256*r[n+1]);return s}function M(t,e,i){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,i,r,s,n){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<n)throw new RangeError('"value" argument is out of bounds');if(i+r>t.length)throw new RangeError("Index out of range")}function L(t,e,i,r){e<0&&(e=65535+e+1);for(var s=0,n=Math.min(t.length-i,2);s<n;++s)t[i+s]=(e&255<<8*(r?s:1-s))>>>8*(r?s:1-s)}function U(t,e,i,r){e<0&&(e=4294967295+e+1);for(var s=0,n=Math.min(t.length-i,4);s<n;++s)t[i+s]=e>>>8*(r?s:3-s)&255}function B(t,e,i,r,s,n){if(i+r>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function F(t,e,i,r,s){return s||B(t,e,i,4,3.4028234663852886e38,-3.4028234663852886e38),Q.write(t,e,i,r,23,4),i+4}function j(t,e,i,r,s){return s||B(t,e,i,8,1.7976931348623157e308,-1.7976931348623157e308),Q.write(t,e,i,r,52,8),i+8}function H(t){if(t=W(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function W(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function Y(t,e){e=e||1/0;for(var i,r=t.length,s=null,n=[],o=0;o<r;++o){if(i=t.charCodeAt(o),i>55295&&i<57344){if(!s){if(i>56319){(e-=3)>-1&&n.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&n.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&n.push(239,191,189),s=i;continue}i=(s-55296<<10|i-56320)+65536}else s&&(e-=3)>-1&&n.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;n.push(i)}else if(i<2048){if((e-=2)<0)break;n.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;n.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;n.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return n}function X(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}function G(t,e){for(var i,r,s,n=[],o=0;o<t.length&&!((e-=2)<0);++o)i=t.charCodeAt(o),r=i>>8,s=i%256,n.push(s),n.push(r);return n}function J(t){return K.toByteArray(H(t))}function q(t,e,i,r){for(var s=0;s<r&&!(s+i>=e.length||s>=t.length);++s)e[s+i]=t[s];return s}function Z(t){return t!==t}var K=i(25),Q=i(26),$=i(27);e.Buffer=o,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:r(),e.kMaxLength=s(),o.poolSize=8192,o._augment=function(t){return t.__proto__=o.prototype,t},o.from=function(t,e,i){return a(null,t,e,i)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(t,e,i){return l(null,t,e,i)},o.allocUnsafe=function(t){return u(null,t)},o.allocUnsafeSlow=function(t){return u(null,t)},o.isBuffer=function(t){return!(null==t||!t._isBuffer)},o.compare=function(t,e){if(!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,r=e.length,s=0,n=Math.min(i,r);s<n;++s)if(t[s]!==e[s]){i=t[s],r=e[s];break}return i<r?-1:r<i?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!$(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var r=o.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var n=t[i];if(!o.isBuffer(n))throw new TypeError('"list" argument must be an Array of Buffers');n.copy(r,s),s+=n.length}return r},o.byteLength=m,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},o.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?x(this,0,t):_.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},o.prototype.compare=function(t,e,i,r,s){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===r&&(r=0),void 0===s&&(s=this.length),e<0||i>t.length||r<0||s>this.length)throw new RangeError("out of range index");if(r>=s&&e>=i)return 0;if(r>=s)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,r>>>=0,s>>>=0,this===t)return 0;for(var n=s-r,a=i-e,d=Math.min(n,a),l=this.slice(r,s),u=t.slice(e,i),h=0;h<d;++h)if(l[h]!==u[h]){n=l[h],a=u[h];break}return n<a?-1:a<n?1:0},o.prototype.includes=function(t,e,i){return this.indexOf(t,e,i)!==-1},o.prototype.indexOf=function(t,e,i){return y(this,t,e,i,!0)},o.prototype.lastIndexOf=function(t,e,i){return y(this,t,e,i,!1)},o.prototype.write=function(t,e,i,r){if(void 0===e)r="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)r=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e=0|e,isFinite(i)?(i=0|i,void 0===r&&(r="utf8")):(r=i,i=void 0)}var s=this.length-e;if((void 0===i||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var n=!1;;)switch(r){case"hex":return A(this,t,e,i);case"utf8":case"utf-8":return E(this,t,e,i);case"ascii":return S(this,t,e,i);case"latin1":case"binary":return k(this,t,e,i);case"base64":return C(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,e,i);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),n=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;o.prototype.slice=function(t,e){var i=this.length;t=~~t,e=void 0===e?i:~~e,t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),e<t&&(e=t);var r;if(o.TYPED_ARRAY_SUPPORT)r=this.subarray(t,e),r.__proto__=o.prototype;else{var s=e-t;r=new o(s,(void 0));for(var n=0;n<s;++n)r[n]=this[n+t]}return r},o.prototype.readUIntLE=function(t,e,i){t=0|t,e=0|e,i||M(t,e,this.length);for(var r=this[t],s=1,n=0;++n<e&&(s*=256);)r+=this[t+n]*s;return r},o.prototype.readUIntBE=function(t,e,i){t=0|t,e=0|e,i||M(t,e,this.length);for(var r=this[t+--e],s=1;e>0&&(s*=256);)r+=this[t+--e]*s;return r},o.prototype.readUInt8=function(t,e){return e||M(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return e||M(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return e||M(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return e||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return e||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,i){t=0|t,e=0|e,i||M(t,e,this.length);for(var r=this[t],s=1,n=0;++n<e&&(s*=256);)r+=this[t+n]*s;return s*=128,r>=s&&(r-=Math.pow(2,8*e)),r},o.prototype.readIntBE=function(t,e,i){t=0|t,e=0|e,i||M(t,e,this.length);for(var r=e,s=1,n=this[t+--r];r>0&&(s*=256);)n+=this[t+--r]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*e)),n},o.prototype.readInt8=function(t,e){return e||M(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},o.prototype.readInt16LE=function(t,e){e||M(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt16BE=function(t,e){e||M(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},o.prototype.readInt32LE=function(t,e){return e||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return e||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return e||M(t,4,this.length),Q.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return e||M(t,4,this.length),Q.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){
return e||M(t,8,this.length),Q.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return e||M(t,8,this.length),Q.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,i,r){if(t=+t,e=0|e,i=0|i,!r){var s=Math.pow(2,8*i)-1;O(this,t,e,i,s,0)}var n=1,o=0;for(this[e]=255&t;++o<i&&(n*=256);)this[e+o]=t/n&255;return e+i},o.prototype.writeUIntBE=function(t,e,i,r){if(t=+t,e=0|e,i=0|i,!r){var s=Math.pow(2,8*i)-1;O(this,t,e,i,s,0)}var n=i-1,o=1;for(this[e+n]=255&t;--n>=0&&(o*=256);)this[e+n]=t/o&255;return e+i},o.prototype.writeUInt8=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,1,255,0),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},o.prototype.writeUInt16BE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},o.prototype.writeUInt32LE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):U(this,t,e,!0),e+4},o.prototype.writeUInt32BE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},o.prototype.writeIntLE=function(t,e,i,r){if(t=+t,e=0|e,!r){var s=Math.pow(2,8*i-1);O(this,t,e,i,s-1,-s)}var n=0,o=1,a=0;for(this[e]=255&t;++n<i&&(o*=256);)t<0&&0===a&&0!==this[e+n-1]&&(a=1),this[e+n]=(t/o>>0)-a&255;return e+i},o.prototype.writeIntBE=function(t,e,i,r){if(t=+t,e=0|e,!r){var s=Math.pow(2,8*i-1);O(this,t,e,i,s-1,-s)}var n=i-1,o=1,a=0;for(this[e+n]=255&t;--n>=0&&(o*=256);)t<0&&0===a&&0!==this[e+n+1]&&(a=1),this[e+n]=(t/o>>0)-a&255;return e+i},o.prototype.writeInt8=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,1,127,-128),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},o.prototype.writeInt16BE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},o.prototype.writeInt32LE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):U(this,t,e,!0),e+4},o.prototype.writeInt32BE=function(t,e,i){return t=+t,e=0|e,i||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},o.prototype.writeFloatLE=function(t,e,i){return F(this,t,e,!0,i)},o.prototype.writeFloatBE=function(t,e,i){return F(this,t,e,!1,i)},o.prototype.writeDoubleLE=function(t,e,i){return j(this,t,e,!0,i)},o.prototype.writeDoubleBE=function(t,e,i){return j(this,t,e,!1,i)},o.prototype.copy=function(t,e,i,r){if(i||(i=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<i&&(r=i),r===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-i&&(r=t.length-e+i);var s,n=r-i;if(this===t&&i<e&&e<r)for(s=n-1;s>=0;--s)t[s+e]=this[s+i];else if(n<1e3||!o.TYPED_ARRAY_SUPPORT)for(s=0;s<n;++s)t[s+e]=this[s+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+n),e);return n},o.prototype.fill=function(t,e,i,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,i=this.length):"string"==typeof i&&(r=i,i=this.length),1===t.length){var s=t.charCodeAt(0);s<256&&(t=s)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t=255&t);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0);var n;if("number"==typeof t)for(n=e;n<i;++n)this[n]=t;else{var a=o.isBuffer(t)?t:Y(new o(t,r).toString()),d=a.length;for(n=0;n<i-e;++n)this[n+e]=a[n%d]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(e,function(){return this}())},function(t,e){"use strict";function i(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");i===-1&&(i=e);var r=i===e?0:4-i%4;return[i,r]}function r(t){var e=i(t),r=e[0],s=e[1];return 3*(r+s)/4-s}function s(t,e,i){return 3*(e+i)/4-i}function n(t){var e,r,n=i(t),o=n[0],a=n[1],d=new h(s(t,o,a)),l=0,c=a>0?o-4:o;for(r=0;r<c;r+=4)e=u[t.charCodeAt(r)]<<18|u[t.charCodeAt(r+1)]<<12|u[t.charCodeAt(r+2)]<<6|u[t.charCodeAt(r+3)],d[l++]=e>>16&255,d[l++]=e>>8&255,d[l++]=255&e;return 2===a&&(e=u[t.charCodeAt(r)]<<2|u[t.charCodeAt(r+1)]>>4,d[l++]=255&e),1===a&&(e=u[t.charCodeAt(r)]<<10|u[t.charCodeAt(r+1)]<<4|u[t.charCodeAt(r+2)]>>2,d[l++]=e>>8&255,d[l++]=255&e),d}function o(t){return l[t>>18&63]+l[t>>12&63]+l[t>>6&63]+l[63&t]}function a(t,e,i){for(var r,s=[],n=e;n<i;n+=3)r=(t[n]<<16&16711680)+(t[n+1]<<8&65280)+(255&t[n+2]),s.push(o(r));return s.join("")}function d(t){for(var e,i=t.length,r=i%3,s=[],n=16383,o=0,d=i-r;o<d;o+=n)s.push(a(t,o,o+n>d?d:o+n));return 1===r?(e=t[i-1],s.push(l[e>>2]+l[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],s.push(l[e>>10]+l[e>>4&63]+l[e<<2&63]+"=")),s.join("")}e.byteLength=r,e.toByteArray=n,e.fromByteArray=d;for(var l=[],u=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,f=c.length;p<f;++p)l[p]=c[p],u[c.charCodeAt(p)]=p;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,i,r,s){var n,o,a=8*s-r-1,d=(1<<a)-1,l=d>>1,u=-7,h=i?s-1:0,c=i?-1:1,p=t[e+h];for(h+=c,n=p&(1<<-u)-1,p>>=-u,u+=a;u>0;n=256*n+t[e+h],h+=c,u-=8);for(o=n&(1<<-u)-1,n>>=-u,u+=r;u>0;o=256*o+t[e+h],h+=c,u-=8);if(0===n)n=1-l;else{if(n===d)return o?NaN:(p?-1:1)*(1/0);o+=Math.pow(2,r),n-=l}return(p?-1:1)*o*Math.pow(2,n-r)},e.write=function(t,e,i,r,s,n){var o,a,d,l=8*n-s-1,u=(1<<l)-1,h=u>>1,c=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:n-1,f=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-o))<1&&(o--,d*=2),e+=o+h>=1?c/d:c*Math.pow(2,1-h),e*d>=2&&(o++,d/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*d-1)*Math.pow(2,s),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;t[i+p]=255&a,p+=f,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[i+p]=255&o,p+=f,o/=256,l-=8);t[i+p-f]|=128*g}},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){var r=i(15),s=i(29),n=i(8),o=i(21),a=i(9).createLogger("js.vastLoader.VastLoader","VastLoader"),d=function(t,e,i){"use strict";this.urlRequestUtils=null,this.xhrCredentialsConfig=i,this.vastParser=new s,this.vast={},this.loading=!1,this.resultCallback=t,this.errorCallback=e,this.debugAlreadySent=!1,this.adsCountLog=!1,this.initVastResult()};d.prototype={initVastResult:function(){"use strict";this.vast={duration:null,errors:[],impressions:[],trackingEvents:{},videoClicks:{clickThrough:"",clickTracking:[]},mediaFiles:[],adParameters:"",companion:"",skip:null,icons:[],adVerifications:[],extensions:{}}},getVAST:function(t){"use strict";this.urlRequestUtils=new r(this.handler.bind(this),this.debugHandler.bind(this),this.xhrCredentialsConfig),this.urlRequestUtils.getXHR(t)},debugHandler:function(t){"use strict";this.debugAlreadySent||(this.errorCallback(t),this.debugAlreadySent=!0)},adCountHandler:function(t){"use strict";t>1&&(this.errorCallback(n.Multiple_Vast_Ads()),this.adsCountLog=!0)},handler:function(t,e){"use strict";if(this.loading||this.initVastResult(),t)this.errorCallback(t,this.vastParser.errorTrackers),this.loading=!1;else{this.loading=!0;var i=null;try{i=this.vastParser.parse(e,this.adCountHandler.bind(this))}catch(r){return r instanceof Error?(a.error("handler",{error:r,message:r.message}),this.errorCallback(n.Vast_Parser_Error(),this.vastParser.errorTrackers)):this.errorCallback(r,this.vastParser.errorTrackers),void(this.loading=!1)}if(!(i&&i.ads&&this.isSupportedAd(i.ads)))return this.errorCallback(n.Ad_Type_Error(),this.vastParser.errorTrackers),void(this.loading=!1);this.vast.errors=this.vast.errors.concat(i.ads.errors),this.vast.impressions=this.vast.impressions.concat(i.ads.impressions),this.registerAdElements(i.ads),i.ads.isWrapper?this.getVAST(o.replaceMacro(i.ads.vastAdTagURI)):(this.vastResult(i.ads),this.loading=!1)}},registerAdElements:function(t){"use strict";var e=this.vastParser.getFirstLinear(t.creatives);if(e){this.vast.videoClicks.clickTracking=this.vast.videoClicks.clickTracking.concat(e.videoClicks.clickTracking),t.isWrapper||(this.vast.videoClicks.clickThrough=e.videoClicks.clickThrough);for(var i=Object.keys(e.trackingEvents),r=0;r<i.length;r++){var s=i[r];this.vast.trackingEvents.hasOwnProperty(s)||(this.vast.trackingEvents[s]=[]),this.vast.trackingEvents[s]=this.vast.trackingEvents[s].concat(e.trackingEvents[s])}}var n=this.vastParser.getFirstCompanion(t.creatives);""!==n&&(this.vast.companion=n),this.vast.adVerifications=this.vast.adVerifications.concat(t.adVerifications);for(var o=Object.keys(t.extensions),a=0;a<o.length;a++)this.vast.extensions[o[a]]=t.extensions[o[a]]},vastResult:function(t){"use strict";var e=this.vastParser.getFirstLinear(t.creatives);this.vast.mediaFiles=e.mediaFiles,this.vast.adParameters=e.adParameters,this.vast.skip=e.skipOffset,this.vast.duration=e.duration,this.vast.icons=e.icons,this.resultCallback(this.vast)},isSupportedAd:function(t){"use strict";return t&&(t.isWrapper||null!==this.vastParser.getFirstLinear(t.creatives))}},t.exports=d},function(t,e,i){var r=i(30),s=i(31),n=i(32),o=i(8),a=i(9).createLogger("js.vastLoader.VastParser","VastParser"),d=function(){"use strict";this.isWrapper=!1,this.errorTrackers=[]};d.prototype={parse:function(t,e){"use strict";var i=(new r).parse(t);if(this.isWrapper=!1,null===i)throw a.error("parse",{message:"Empty or malformed VAST content"}),o.Xml_Parsing_Error();if(i.root&&i.root.name===n.Vast_Node_Name){i=i.root;var s="",d=null;i.attributes[n.Version_Attribute_Name]&&(s=i.attributes[n.Version_Attribute_Name]),e&&e(this.getAdsCount(i));var l=this.getFirstChild(i,n.Ad_Node_Name);if(!l)throw o.Vast_Validation_Error();return d=this.parseAd(l),{version:s,ads:d}}throw o.Vast_Validation_Error()},parseAd:function(t){"use strict";var e={adInfo:{id:this.getAttributeToString(t.attributes,n.Id_Attribute_Name),adSystem:{}},isWrapper:!1,vastAdTagURI:"",creatives:[],errors:[],impressions:[],adVerifications:[],extensions:{}},i=this.getFirstChild(t,n.Inline_Node_Name);if(i)e.adInfo=this.concatObj(e.adInfo,this.parseInline(i));else{if(i=this.getFirstChild(t,n.Wrapper_Node_Name),!i)throw o.Vast_Validation_Error();e.isWrapper=!0}for(var r=i.children,s=0;s<r.length;s++)r[s].name===n.Impression_Node_Name&&""!==r[s].content?e.impressions.push(r[s].content):r[s].name===n.Error_Node_Name&&""!==r[s].content&&(e.errors.push(r[s].content),this.errorTrackers.push(r[s].content));e.isWrapper&&(e.vastAdTagURI=this.parseWrapper(i));var d=this.getFirstChild(i,n.Adsystem_Node_Name);if(d&&(e.adInfo.adSystem=this.parseAdSystem(d)),d=this.getFirstChild(i,n.Creatives_Node_Name)){for(var l=0;l<d.children.length;l++){var u=this.parseCreative(d.children[l]);u&&e.creatives.push(u)}if(!e.creatives.length&&!e.isWrapper)throw o.General_Linear_Error()}else if(!e.isWrapper)throw o.Vast_Validation_Error();if(d=this.getFirstChild(i,n.Ad_Verifications_Node_Name))for(var h=0;h<d.children.length;h++)try{var c=this.parseVerification(d.children[h]);c&&(c.nodeLocation=n.Ad_Verifications_Node_Name,e.adVerifications.push(c))}catch(p){a.error("parse",{message:"Empty or malformed ADVerification content",value:d.children[h]})}return d=this.getFirstChild(i,n.Extensions_Node_Name),d&&(e.extensions=this.parseExtensions(d.children)),e.extensions.adVerifications&&(e.adVerifications=e.adVerifications.concat(e.extensions.adVerifications),delete e.extensions.adVerifications),e},parseInline:function(t){"use strict";var e={},i=this.getFirstChild(t,n.Description_Node_Name);return i&&(e.description=i.content),i=this.getFirstChild(t,n.Survey_Node_Name),i&&(e.survey=i.content),i=this.getFirstChild(t,n.Adtitle_Node_Name),i&&(e.title=i.content),e},parseWrapper:function(t){"use strict";if(t=this.getFirstChild(t,n.Vast_Ad_Tag_Uri_Node_Name),!t)throw o.General_Wrapper_Error();var e=t.content;if(e&&""!==e)return this.isWrapper=!0,e;throw o.General_Wrapper_Error()},parseAdSystem:function(t){"use strict";return{version:this.getAttributeToString(t.attributes,n.Version_Attribute_Name),value:t.content}},parseCreative:function(t){"use strict";var e={id:this.getAttributeToString(t.attributes,n.Id_Attribute_Name),adId:this.getAttributeToString(t.attributes,n.Adid_Attribute_Name),sequence:null},i=this.getAttributeToNumber(t.attributes,n.Sequence_Attribute_Name);isNaN(i)||(e.sequence=i);var r=this.getFirstChild(t,n.Linear_Node_Name),s=this.getFirstChild(t,n.Companion_Ads_Node_Name);if(r)e.type=n.Linear,e.linear=this.parseLinear(r);else if(s)e.type=n.Companion,e.companion=this.serializeToXml(s);else if(!this.isWrapper)return null;return e},parseLinear:function(t){"use strict";var e={duration:new s,skipOffset:this.getAttributeToString(t.attributes,n.Skip_Offset_Attribute_Name),trackingEvents:{},videoClicks:{clickThrough:"",clickTracking:[]},mediaFiles:[],adParameters:"",icons:[]},i=this.getFirstChild(t,n.Duration_Node_Name);if(i){var r=i.content;""!==r&&(e.duration=new s(r))}return i=this.getFirstChild(t,n.Tracking_Events_Node_Name),i&&(e.trackingEvents=this.parseTrackingEvent(i.children)),i=this.getFirstChild(t,n.Video_Clicks_Node_Name),i&&(e.videoClicks=this.parseVideoClicks(i.children)),i=this.getFirstChild(t,n.Media_Files_Node_Name),i&&!this.isWrapper&&(e.mediaFiles=this.parseMediaFile(i.children)),i=this.getFirstChild(t,n.Ad_Parameters_Node_Name),i&&!this.isWrapper&&(e.adParameters=i.content),i=this.getFirstChild(t,n.Icons_Node_Name),i&&(e.icons=this.parseIcons(i.children)),e},parseTrackingEvent:function(t){"use strict";for(var e={},i=0;i<t.length;i++)if(t[i].name===n.Tracking_Node_Name){var r=this.getAttributeToString(t[i].attributes,n.Event_Attribute_Name);if(r&&n.Available_Events.indexOf(r)!==-1){e.hasOwnProperty(r)||(e[r]=[]);var s=t[i].content;""!==s&&("progress"!=r?e[r].push(s):e[r].push({url:s,offset:this.getAttributeToString(t[i].attributes,n.Offset_Attribute_Name)}))}}return e},parseVideoClicks:function(t){"use strict";for(var e={clickThrough:"",clickTracking:[]},i=0;i<t.length;i++){var r="",s=t[i];s.name===n.Click_Through_Node_Name&&""===e.clickThrough&&(r=s.content,""!==r&&(e.clickThrough=r)),s.name===n.Click_Tracking_Node_Name&&(r=s.content,""!==r&&e.clickTracking.push(r))}return e},parseMediaFile:function(t){"use strict";var e=[];if(0===t.length)throw o.Vast_Validation_Error();for(var i=0;i<t.length;i++)if(t[i].name===n.Media_File_Node_Name){var r=!0,s=t[i].attributes,a={id:this.getAttributeToString(s,n.Id_Attribute_Name)},d=this.getAttributeToString(s,n.Delivery_Attribute_Name);d&&n.Supported_Delivery_Type.indexOf(d)!==-1||(d=n.Supported_Delivery_Type[0]),a.delivery=d,d=this.getAttributeToString(s,n.Type_Attribute_Name),d&&n.Supported_Video_Type.indexOf(d.toLowerCase())!==-1||(r=!1),a.type=d.toLowerCase(),d=this.getAttributeToNumber(s,n.Bitrate_Attribute_Name),(d<0||null===d)&&(d=0),a.bitrate=d,d=this.getAttributeToNumber(s,n.Width_Attribute_Name),(d<0||null===d)&&(d=0),a.width=d,d=this.getAttributeToNumber(s,n.Height_Attribute_Name),(d<0||null===d)&&(d=0),a.height=d,a.scalable=this.getAttributeToBoolean(s,n.Scalable_Attribute_Name),null===a.scalable&&(a.scalable=!0),a.maintainAspectRatio=this.getAttributeToBoolean(s,n.Maintain_Aspect_Ratio_Attribute_Name),null===a.maintainAspectRatio&&(a.maintainAspectRatio=!0),d=this.getAttributeToString(s,n.Api_Framework_Attribute_Name),d&&(d=d.toUpperCase(),d===n.Vpaid_Api&&n.Supported_Vpaid_Type.indexOf(a.type)!==-1?a.apiFramework=d:r=!1),d=t[i].content,d||(r=!1),a.url=d,r&&e.push(a)}return e},parseIcons:function(t){for(var e=[],i=0;i<t.length;i++)if(t[i].name===n.Icon_Node_Name){var r=t[i].attributes,o={program:"",width:0,height:0,xPosition:0,yPosition:0,apiFramework:"",offset:new s,duration:new s,IconClickThrough:"",IconClickTracking:[],IconViewTracking:[],StaticResource:{type:null,src:null},IFrameResource:null,HTMLResource:null},a=this.getAttributeToString(r,n.Program_Attribute_Name);if(""!==a&&null!==a){for(var d=!1,l=0;l<e.length;l++)e[l].program===a&&(d=!0);if(d)continue;o.program=a}if(""===o.program)continue;if(a=this.getAttributeToNumber(r,n.Width_Attribute_Name),!(a>0&&null!==a))continue;if(o.width=a,a=this.getAttributeToNumber(r,n.Height_Attribute_Name),!(a>0&&null!==a))continue;if(o.height=a,a=this.getAttributeToString(r,n.X_Position_Attribute_Name),""!==a&&null!==a){var u=parseInt(a);"left"===a||"right"===a?o.xPosition=a:a>=0&&null!==a&&(o.xPosition=u)}if(a=this.getAttributeToString(r,n.Y_Position_Attribute_Name),""!==a&&null!==a){var h=parseInt(a);"top"===a||"bottom"===a?o.yPosition=a:a>=0&&null!==a&&(o.yPosition=h)}a=this.getAttributeToString(r,n.Api_Framework_Attribute_Name),""!==a&&null!==a&&(o.apiFramework=a),a=this.getAttributeToString(r,n.Offset_Attribute_Name),""!==a&&null!==a&&(o.offset=new s(a)),a=this.getAttributeToString(r,n.Duration_Attribute_Name),""!==a&&null!==a&&(o.duration=new s(a));var c=this.getFirstChild(t[i],n.Icon_Clicks_Node_Name);if(c)for(var p=0;p<c.children.length;p++){a="";var f=c.children[p];f.name===n.Icon_Click_Through_Node_Name&&""===o.IconClickThrough&&(a=f.content,""!==a&&(o.IconClickThrough=a)),f.name===n.Icon_Click_Tracking_Node_Name&&(a=f.content,""!==a&&o.IconClickTracking.push(a))}for(var g=0;g<t[i].children.length;g++){var v=t[i].children[g];v.name===n.Icon_View_Tracking_Node_Name&&(a=v.content,""!==a&&o.IconViewTracking.push(a))}var m=this.getFirstChild(t[i],n.Static_Resource_Node_Name);if(m){if(a=this.getAttributeToString(m.attributes,n.Creative_Type_Attribute_Name),""===a||null===a||n.Supported_Icon_Type.indexOf(a.toLowerCase())===-1)continue;o.StaticResource.type=a.toLowerCase(),o.StaticResource.src=m.content}m=this.getFirstChild(t[i],n.Iframe_Resource_Node_Name),m&&(o.IFrameResource=m.content),m=this.getFirstChild(t[i],n.Html_Resource_Node_Name),m&&(o.HTMLResource=m.content),e.push(o)}return e},parseVerification:function(t){"use strict";var e={vendor:"",src:"",apiFramework:"",browserOptional:!1,trackingEvents:{},verificationParameters:"",nodeLocation:""},i=this.getAttributeToString(t.attributes,n.Vendor_Attribute_Name);if(""===i||null===i)return null;e.vendor=i;var r=this.getFirstChild(t,n.JavaScript_Resource_Node_Name);if(!r)return null;if(i=r.content,""!==i&&(e.src=i),i=this.getAttributeToString(r.attributes,n.Api_Framework_Attribute_Name),""!==i&&null!==i&&(e.apiFramework=i),i=this.getAttributeToString(r.attributes,n.Browser_Optional_Attribute_Name),""!==i&&null!==i&&("true"===i?e.browserOptional=!0:"false"===i&&(e.browserOptional=!1)),r=this.getFirstChild(t,n.Verification_Parameters_Node_Name),r&&(i=r.content,""!==i&&(e.verificationParameters=i)),r=this.getFirstChild(t,n.Tracking_Events_Node_Name))for(var s=r.children,o=0;o<s.length;o++){var a=this.getAttributeToString(s[o].attributes,n.Event_Attribute_Name);if(a&&n.Available_Verification_Events.indexOf(a)!==-1){e.trackingEvents.hasOwnProperty(a)||(e.trackingEvents[a]=[]);var d=s[o].content;""!==d&&e.trackingEvents[a].push(d)}}return e},parseExtensions:function(t){"use strict";for(var e={},i=0;i<t.length;i++){var r=t[i];if(r.name===n.Extension_Node_Name){var s=this.getAttributeToString(r.attributes,n.Type_Attribute_Name);if(s===n.Omid_Extension_Type){e.adVerifications=[];var o=this.getFirstChild(r,n.Ad_Verifications_Node_Name);if(o)for(var d=0;d<o.children.length;d++)try{var l=this.parseVerification(o.children[d]);l&&(l.nodeLocation=n.Extension_Node_Name,e.adVerifications.push(l))}catch(u){a.error("parse",{message:"Empty or malformed ADVerification content",value:o.children[d]})}}if(s===n.MSAN_View_Beacon_Extension_Type){var h=this.getFirstChild(r,n.MSAN_View_Beacon_Extension_Type);h&&(e.MSANViewBeacon=h)}if(s===n.Monetize_Viewability_Config_Extension_Type){var c=this.parseMonetizeViewabilityConfig(r);Object.keys(c).length>0&&(e.monetizeViewabilityConfig=c)}}}return e},parseMonetizeViewabilityConfig:function(t){"use strict";for(var e={},i=n.Viewability_Provider_Config_Node_Names,r=function(i){var r=this.getFirstChild(t,i);r&&(e[i]=r)}.bind(this),s=0;s<i.length;s++)r(i[s]);return e},getAdsCount:function(t){"use strict";var e=0;if(!t)return 0;for(var i=0;i<t.children.length;i++)t.children[i].name===n.Ad_Node_Name&&e++;return e},getFirstChild:function(t,e){"use strict";if(!t||!e)return null;for(var i=0;i<t.children.length;i++)if(t.children[i].name===e)return t.children[i];return null},getAttributeToString:function(t,e){"use strict";if(t.hasOwnProperty(e)){var i=t[e];return"string"==typeof i&&(i=i.trim()),String(i)}return null},getAttributeToNumber:function(t,e){"use strict";var i=this.getAttributeToString(t,e);return i=parseInt(i),isNaN(i)?null:i},getAttributeToBoolean:function(t,e){"use strict";var i=this.getAttributeToString(t,e);return i?(i=i.toLowerCase(),"false"!==i&&("true"===i||(i=parseInt(i),!isNaN(i)&&0!==i))):null},concatObj:function(){for(var t={},e=arguments.length,i=0;i<e;i++){if("object"!=typeof arguments[i])return{};for(var r in arguments[i])arguments[i].hasOwnProperty(r)&&(t[r]=arguments[i][r])}return t},getFirstLinear:function(t){"use strict";for(var e=0;e<t.length;e++)if(t[e].type===n.Linear)return t[e].linear;return null},getFirstCompanion:function(t){"use strict";for(var e=0;e<t.length;e++)if(t[e].type===n.Companion)return t[e].companion;return""},serializeToXml:function(t){var e="";if(e+="<"+t.name,"{}"!==t.attributes.toString())for(var i in t.attributes)e+=" "+i+'="'+t.attributes[i]+'"';if(e+=">",0===t.children.length)e+=t.content?"<![CDATA["+t.content.replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>":t.content;else for(var r=0;r<t.children.length;r++)e+=this.serializeToXml(t.children[r]);return 0===t.children.length&&""===t.content?e=e.substr(0,e.length-1)+"/>":e+="</"+t.name+">",e}},t.exports=d},function(t,e){var i=2,r=3,s=4,n=5,o=function(){"use strict";this.xml="",this.hasError=0};o.prototype={parse:function(t){"use strict";if(!t)return null;this.xml=t.trim().replace(/<!--[\s\S]*?-->|[\t\n\r]\s*/g," ");var e=this.declaration();if(this.hasError)return null;var i=this.tag();return this.hasError?null:i?{declaration:e,root:i}:(this.hasError=n,null)},declaration:function(){"use strict";var t=this.match(/^<\?xml\s*/);if(!t)return null;for(var e={attributes:{}};!this.eos()&&!this.is("?>");){var i=this.attribute();if(!i){if(this.hasError)return null;break}e.attributes[i.name]=i.value}return this.match(/^\?>\s*/)?e:(this.hasError=r,null)},tag:function(){"use strict";var t=this.match(/^<([\w-:.]+)\s*/);if(!t)return null;if(this.is("<"))return this.hasError=r,null;for(var e={name:t[1],attributes:{},children:[],content:""};!(this.eos()||this.is(">")||this.is("?>")||this.is("/>"));){var i=this.attribute();if(!i){if(this.hasError)return null;break}e.attributes[i.name]=i.value}if(this.match(/^\s*\/>\s*/))return e;if(!this.match(/^>\s*/))return this.hasError=r,null;if(e.content=this.content(),0!==e.children.length&&""!==e.content)return this.hasError=CONTENT_ASIDE_CHILD,null;for(var n=!1;!n;){var o=this.tag();if(o)e.children.push(o);else{if(this.hasError)return null;n=!0}}return this.match(new RegExp("^</"+e.name+">\\s*"))?e:(this.hasError=s,null)},content:function(){"use strict";var t,e="";if(this.is("<![CDATA[")){for(var i="",r=!1;!r;)this.is("<![CDATA[")?(t=this.match(/^(<!\[CDATA\[\s*.*?\s*\]\]>\s*)/),t?i+=t[1].trim():r=!0):r=!0;i=i.replace(/\s*\]\]>\s*<!\[CDATA\[\s*/g,""),e=i.substr(9,i.length-12).trim()}else t=this.match(/^([^<]*)/),t&&(e=t[1].trim(),e&&(e=this.decodeXml_(e)));return e},attribute:function(){"use strict";var t=this.match(/([\w:-]+)\s*=\s*("[^"]*"|'[^']*'|)\s*/);return t?""!==t[2]&&t[2].indexOf("=")==-1&&t[2].indexOf(">")==-1||this.xml.match(/^([\?\/]?>|[\w:-]+\s*=)/)?{name:t[1],value:this.strip(t[2]).trim()}:(this.hasError=i,null):null},strip:function(t){"use strict";return"string"!=typeof t?null:t.replace(/^['"]|['"]$/g,"")},match:function(t){"use strict";if(!(t instanceof RegExp))return null;var e=this.xml.match(t);return e?(this.xml=this.xml.slice(e[0].length),e):null},eos:function(){"use strict";return 0===this.xml.length},is:function(t){"use strict";return"string"==typeof t&&""!==t&&0===this.xml.indexOf(t)},decodeXml_:function(t){return t.replace(/(&apos;|&quot;|&lt;|&gt;|&amp;)/g,function(t,e){return{"&amp;":"&","&quot;":'"',"&apos;":"'","&lt;":"<","&gt;":">"}[e]})}},t.exports=o},function(t,e){var i=function(t,e){"use strict";this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0,this.isInitialized=!1,this.parse(t,e)};i.prototype={parse:function(t,e){"use strict";if(t||0===t){if("number"==typeof t)return void this.parseMillisecond(t);if("string"==typeof t)if(t.indexOf(":")!==-1){var i=t.split(":");if(3!=i.length)return;this.hours=this.validateNumber(i[0]),this.minutes=this.validateNumber(i[1]),i=i[2].split("."),this.seconds=this.validateNumber(i[0]),this.milliseconds=this.validateNumber(i[1]),this.isInitialized=!0,this.parseMillisecond(this.toMillisecond())}else t.indexOf("%")!==-1&&"number"==typeof e&&(this.parseMillisecond(e),this.percentTime(t))}},parseMillisecond:function(t){"use strict";return!t&&0!==t||"number"!=typeof t||t<0?void(this.isInitialized=!1):(this.milliseconds=t%1e3,this.seconds=Math.floor(t/1e3)%60,this.minutes=Math.floor(t/6e4)%60,this.hours=Math.floor(t/36e5),void(this.isInitialized=!0))},validateNumber:function(t){"use strict";var e=parseInt(t);return isNaN(e)||e<0?0:e},toString:function(){"use strict";return(this.hours<10?"0":"")+this.hours+":"+(this.minutes<10?"0":"")+this.minutes+":"+(this.seconds<10?"0":"")+this.seconds+"."+(this.milliseconds<100?"0":"")+(this.milliseconds<10?"0":"")+this.milliseconds},toSecond:function(){"use strict";if(this.isInitialized){var t=this.seconds;return 0!==this.minutes&&(t+=60*this.minutes),0!==this.hours&&(t+=3600*this.hours),t}return-1},toMillisecond:function(){"use strict";return this.isInitialized?1e3*this.toSecond()+this.milliseconds:-1},decrease:function(t){"use strict";if(this.isInitialized){if(!t||"number"!=typeof t||t<0)return!1;var e=1e3*this.toSecond()+this.milliseconds-t;if(e<=0)return this.parseMillisecond(0),!0;this.parseMillisecond(e)}return!1},percentTime:function(t){"use strict";if(!t||"string"!=typeof t||0===t.length||t.indexOf("%")!==t.length-1||isNaN(Number(t.substr(0,t.length-1))))return this.parseMillisecond(0),void(this.isInitialized=!1);t=Number(t.substr(0,t.length-1));var e=this.toMillisecond();e*=t/100,this.parseMillisecond(Math.floor(e))}},t.exports=i},function(t,e){t.exports={Vast_Node_Name:"VAST",Ad_Node_Name:"Ad",Inline_Node_Name:"InLine",Wrapper_Node_Name:"Wrapper",Adsystem_Node_Name:"AdSystem",Creatives_Node_Name:"Creatives",Creative_Node_Name:"Creative",Error_Node_Name:"Error",Impression_Node_Name:"Impression",Description_Node_Name:"Description",Survey_Node_Name:"Survey",Adtitle_Node_Name:"AdTitle",Vast_Ad_Tag_Uri_Node_Name:"VASTAdTagURI",Ad_Parameters_Node_Name:"AdParameters",Linear_Node_Name:"Linear",Duration_Node_Name:"Duration",Tracking_Events_Node_Name:"TrackingEvents",Tracking_Node_Name:"Tracking",Video_Clicks_Node_Name:"VideoClicks",Media_Files_Node_Name:"MediaFiles",Media_File_Node_Name:"MediaFile",Click_Through_Node_Name:"ClickThrough",Click_Tracking_Node_Name:"ClickTracking",Companion_Ads_Node_Name:"CompanionAds",Icons_Node_Name:"Icons",Icon_Node_Name:"Icon",Icon_Clicks_Node_Name:"IconClicks",Icon_Click_Through_Node_Name:"IconClickThrough",Icon_Click_Tracking_Node_Name:"IconClickTracking",Icon_View_Tracking_Node_Name:"IconViewTracking",Static_Resource_Node_Name:"StaticResource",Iframe_Resource_Node_Name:"IFrameResource",Html_Resource_Node_Name:"HTMLResource",Extensions_Node_Name:"Extensions",Extension_Node_Name:"Extension",Ad_Verifications_Node_Name:"AdVerifications",Verification_Node_Name:"Verification",JavaScript_Resource_Node_Name:"JavaScriptResource",Verification_Parameters_Node_Name:"VerificationParameters",Version_Attribute_Name:"version",Id_Attribute_Name:"id",Sequence_Attribute_Name:"sequence",Adid_Attribute_Name:"AdID",Event_Attribute_Name:"event",Delivery_Attribute_Name:"delivery",Type_Attribute_Name:"type",Bitrate_Attribute_Name:"bitrate",Width_Attribute_Name:"width",Height_Attribute_Name:"height",Offset_Attribute_Name:"offset",Skip_Offset_Attribute_Name:"skipoffset",Maintain_Aspect_Ratio_Attribute_Name:"maintainAspectRatio",Api_Framework_Attribute_Name:"apiFramework",Scalable_Attribute_Name:"scalable",Program_Attribute_Name:"program",X_Position_Attribute_Name:"xPosition",Y_Position_Attribute_Name:"yPosition",Duration_Attribute_Name:"duration",Creative_Type_Attribute_Name:"creativeType",Vendor_Attribute_Name:"vendor",Browser_Optional_Attribute_Name:"browserOptional",Linear:"linear",Companion:"companion",Non_Linear:"nonLinear",Available_Events:["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","mute","unmute","pause","rewind","resume","fullscreen","exitFullscreen","expand","collapse","acceptInvitation","acceptInvitationLinear","close","closeLinear","skip","progress"],Available_Verification_Events:["verificationNotExecuted"],Omid_Extension_Type:"AdVerifications",MSAN_View_Beacon_Extension_Type:"MSANViewBeacon",Monetize_Viewability_Config_Extension_Type:"MonetizeViewabilityConfig",Viewability_Provider_Config_Node_Names:["TRKJSConfig","IASConfig","DVConfig"],Supported_Delivery_Type:["progressive","streaming"],Supported_Video_Type:["video/mpeg","video/mp4","video/webm","video/quicktime","video/x-msvideo","application/x-javascript","application/javascript"],Supported_Vpaid_Type:["application/x-javascript","application/javascript"],Not_Supported_Video_Type:["video/x-flv","video/flv","video/3gpp","video/x-ms-wmv","application/x-mpegURL","video/MP2T"],Vpaid_Api:"VPAID",Supported_Icon_Type:["image/jpeg","image/jpg","image/gif","image/png"]}},function(t,e,i){var r=i(34),s=i(9).createLogger("js.vastLoader.RenditionSelector","RenditionSelector"),n=0,o=1,a=800,d=400,l=function(t,e,i){"use strict";i?this.deviceDetection=i:this.deviceDetection=new r,this.availableTypes={html5:["video/mp4","video/webm","video/ogg","application/javascript","application/x-javascript"]},this.preference={bitrate:o},this.videoSlot=e||{},this.mediaFilesVPAIDJs=[],this.mediaFilesVideo=[],this.defaultBitrate=a,t&&(this.filterTypeByBrowser(),this.mediaListsInit(t))};l.prototype={filterTypeByBrowser:function(){this.defaultBitrate=a;var t=!!this.videoSlot.canPlayType;try{if(t){var e=!0,i=!0,r=!0,n=this.videoSlot.canPlayType("video/ogg");""!==n&&"no"!==n&&void 0!==n||(this.removeSupport("html5","video/ogg"),e=!1),n=this.videoSlot.canPlayType("video/mp4"),""!==n&&"no"!==n&&void 0!==n||(this.removeSupport("html5","video/mp4"),i=!1),n=this.videoSlot.canPlayType("video/webm"),""!==n&&"no"!==n&&void 0!==n||(this.removeSupport("html5","video/webm"),r=!1),s.debug("filterTypeByBrowser",{ogg:this.videoSlot.canPlayType("video/ogg"),mp4:this.videoSlot.canPlayType("video/mp4"),webm:this.videoSlot.canPlayType("video/webm")}),e||i||r||(t=!1,this.availableTypes.html5=["video/mp4","video/webm","video/ogg","application/javascript","application/x-javascript"])}}catch(o){s.error("filterTypeByBrowser",{error:o.message}),t=!1}if(!t)switch(this.deviceDetection.getBrowser()){case"IE":this.removeSupport("html5","video/webm"),this.removeSupport("html5","video/ogg");break;case"IE Mobile":this.removeSupport("html5","video/webm"),this.removeSupport("html5","video/ogg");
break;case"Edge":this.removeSupport("html5","video/ogg");break;case"Safari":case"Mobile Safari":this.removeSupport("html5","video/webm"),this.removeSupport("html5","video/ogg");break;case"Android Browser":this.removeSupport("html5","video/ogg");break;case"Opera Mini":this.removeSupport("html5","video/mp4"),this.removeSupport("html5","video/webm"),this.removeSupport("html5","video/ogg")}if(this.deviceDetection.getIsIOS()||this.deviceDetection.getIsAndroid()||["Android","iOS","Windows Phone","Windows Mobile","BlackBerry"].indexOf(this.deviceDetection.getOS())!==-1)return void(this.defaultBitrate=d)},removeSupport:function(t,e){if(this.availableTypes.hasOwnProperty(t)){var i=this.availableTypes[t].indexOf(e);i!==-1&&this.availableTypes[t].splice(i,1)}},mediaListsInit:function(t){"use strict";if(this.mediaFilesVPAIDJs=[],this.mediaFilesVideo=[],t&&t.length)for(var e=0;e<t.length;e++){var i=t[e];i.hasOwnProperty("type")&&i.hasOwnProperty("url")&&""!==i.url&&((!i.hasOwnProperty("width")||"number"!=typeof i.width||i.width<0)&&(i.width=0),(!i.hasOwnProperty("height")||"number"!=typeof i.height||i.height<0)&&(i.height=0),(!i.hasOwnProperty("bitrate")||"number"!=typeof i.bitrate||i.bitrate<0)&&(i.bitrate=2147483647),i.hasOwnProperty("apiFramework")&&0===i.apiFramework.toLowerCase().indexOf("vpaid")?this.isHtml5Type(i.type)&&this.mediaFilesVPAIDJs.push(i):this.isHtml5Type(i.type)&&this.mediaFilesVideo.push(i))}},getMedia:function(t,e,i,r){"use strict";if(this.mediaFilesVPAIDJs.length>0)return this.mediaFilesVPAIDJs[0];if(this.mediaFilesVideo.length>0){this.setPreference(r),(!i||i<=0)&&(i=this.defaultBitrate),this.mediaFilesVideo=this.orderBitRate(this.mediaFilesVideo);var s=this.selectMediaFile(t,i,this.mediaFilesVideo);if(s)return s}return null},selectMediaFile:function(t,e,i){"use strict";for(var r={},o=0;o<i.length&&i[o].width>=t;o++)r.hasOwnProperty(i[o].width)||(r[i[o].width]=[]),r[i[o].width].push(i[o]);var a=Object.keys(r).sort(function(t,e){return t-e});if(!(a.length>0))return i.length>0?this.selectMediaFile(i[0].width,e,i):null;r=r[a[0]];var d=null;if(1===r.length)d=r[0];else{for(var l=0;l<r.length;l++){if(!(r[l].bitrate>=e)){this.preference.bitrate===n&&(d=r[l]);break}d=r[l]}null===d&&(d=r[0])}return s.debug("selectedMedia",{width:d.width,height:d.height,bitrate:d.bitrate,type:d.type}),d},setPreference:function(t){"use strict";this.preference.bitrate=-1,t&&"object"==typeof t&&t.hasOwnProperty("bitrate")&&"string"==typeof t.bitrate&&("lowest"===t.bitrate.toLowerCase()?this.preference.bitrate=n:"highest"===t.bitrate.toLowerCase()&&(this.preference.bitrate=o)),this.preference.bitrate==-1&&(this.preference.bitrate=o)},orderBitRate:function(t){"use strict";var e=t.sort(function(t,e){if(t.width>=e.width){if(t.bitrate>e.bitrate)return-1;if(t.bitrate<e.bitrate)return 1}else if(t.width<e.width)return 1;return 0});return e},isHtml5Type:function(t){"use strict";return this.availableTypes.html5.indexOf(t)>-1}},t.exports=l,t.exports.DEFAULT_BITRATE_DESKTOP=a,t.exports.DEFAULT_BITRATE_MOBILE=d},function(t,e,i){var r=i(35),s=i(9).createLogger("js.utils.DeviceDetectionUtils","DeviceDetectionUtils"),n=function(t){"use strict";var e=t&&t.userAgent?t:navigator,i=new r(e.userAgent),n=/iPad|iPhone|iPod/.test(e.userAgent),o=e.userAgent.includes("Macintosh"),a=e.maxTouchPoints>=1;this.os=i.getOS().name,this.isIOS="iOS"===this.os||n||o&&a,this.isAndroid="Android"===this.os,this.browser=i.getBrowser().name,s.debug("DeviceDetectionUtils",{getOs:i.getOS(),userAgent:e.userAgent,platform:e.platform,os:this.os,browser:this.browser,isIOS:this.isIOS,isAndroid:this.isAndroid})};n.prototype={getIsIOS:function(){"use strict";return this.isIOS},getIsAndroid:function(){"use strict";return this.isAndroid},getBrowser:function(){"use strict";return this.browser},getOS:function(){"use strict";return this.os}},t.exports=n},function(t,e,i){var r;!function(s,n){"use strict";var o="1.0.2",a="",d="?",l="function",u="undefined",h="object",c="string",p="major",f="model",g="name",v="type",m="vendor",_="version",b="architecture",y="console",w="mobile",A="tablet",E="smarttv",S="wearable",k="embedded",C=255,I="Amazon",T="Apple",x="ASUS",N="BlackBerry",R="Browser",V="Chrome",P="Edge",D="Firefox",M="Google",O="Huawei",L="LG",U="Microsoft",B="Motorola",F="Opera",j="Samsung",H="Sony",W="Xiaomi",z="Zebra",Y="Facebook",X=function(t,e){var i={};for(var r in t)e[r]&&e[r].length%2===0?i[r]=e[r].concat(t[r]):i[r]=t[r];return i},G=function(t){for(var e={},i=0;i<t.length;i++)e[t[i].toUpperCase()]=t[i];return e},J=function(t,e){return typeof t===c&&q(e).indexOf(q(t))!==-1},q=function(t){return t.toLowerCase()},Z=function(t){return typeof t===c?t.replace(/[^\d\.]/g,a).split(".")[0]:n},K=function(t,e){if(typeof t===c)return t=t.replace(/^\s\s*/,a).replace(/\s\s*$/,a),typeof e===u?t:t.substring(0,C)},Q=function(t,e){for(var i,r,s,o,a,d,u=0;u<e.length&&!a;){var c=e[u],p=e[u+1];for(i=r=0;i<c.length&&!a;)if(a=c[i++].exec(t))for(s=0;s<p.length;s++)d=a[++r],o=p[s],typeof o===h&&o.length>0?2===o.length?typeof o[1]==l?this[o[0]]=o[1].call(this,d):this[o[0]]=o[1]:3===o.length?typeof o[1]!==l||o[1].exec&&o[1].test?this[o[0]]=d?d.replace(o[1],o[2]):n:this[o[0]]=d?o[1].call(this,d,o[2]):n:4===o.length&&(this[o[0]]=d?o[3].call(this,d.replace(o[1],o[2])):n):this[o]=d?d:n;u+=2}},$=function(t,e){for(var i in e)if(typeof e[i]===h&&e[i].length>0){for(var r=0;r<e[i].length;r++)if(J(e[i][r],t))return i===d?n:i}else if(J(e[i],t))return i===d?n:i;return t},tt={"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},et={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},it={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[_,[g,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[_,[g,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[g,_],[/opios[\/ ]+([\w\.]+)/i],[_,[g,F+" Mini"]],[/\bopr\/([\w\.]+)/i],[_,[g,F]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[g,_],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[_,[g,"UC"+R]],[/\bqbcore\/([\w\.]+)/i],[_,[g,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[_,[g,"WeChat"]],[/konqueror\/([\w\.]+)/i],[_,[g,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[_,[g,"IE"]],[/yabrowser\/([\w\.]+)/i],[_,[g,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[g,/(.+)/,"$1 Secure "+R],_],[/\bfocus\/([\w\.]+)/i],[_,[g,D+" Focus"]],[/\bopt\/([\w\.]+)/i],[_,[g,F+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[_,[g,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[_,[g,"Dolphin"]],[/coast\/([\w\.]+)/i],[_,[g,F+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[_,[g,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[_,[g,D]],[/\bqihu|(qi?ho?o?|360)browser/i],[[g,"360 "+R]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[g,/(.+)/,"$1 "+R],_],[/(comodo_dragon)\/([\w\.]+)/i],[[g,/_/g," "],_],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[g,_],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[g],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[g,Y],_],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[g,_],[/\bgsa\/([\w\.]+) .*safari\//i],[_,[g,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[_,[g,V+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[g,V+" WebView"],_],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[_,[g,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[g,_],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[_,[g,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[_,g],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[g,[_,$,tt]],[/(webkit|khtml)\/([\w\.]+)/i],[g,_],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[g,"Netscape"],_],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[_,[g,D+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[g,_]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[b,"amd64"]],[/(ia32(?=;))/i],[[b,q]],[/((?:i[346]|x)86)[;\)]/i],[[b,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[b,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[b,"armhf"]],[/windows (ce|mobile); ppc;/i],[[b,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[b,/ower/,a,q]],[/(sun4\w)[;\)]/i],[[b,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[b,q]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[f,[m,j],[v,A]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[f,[m,j],[v,w]],[/\((ip(?:hone|od)[\w ]*);/i],[f,[m,T],[v,w]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[f,[m,T],[v,A]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[f,[m,O],[v,A]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[f,[m,O],[v,w]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[f,/_/g," "],[m,W],[v,w]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[f,/_/g," "],[m,W],[v,A]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[f,[m,"OPPO"],[v,w]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[f,[m,"Vivo"],[v,w]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[f,[m,"Realme"],[v,w]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[f,[m,B],[v,w]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[f,[m,B],[v,A]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[f,[m,L],[v,A]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[f,[m,L],[v,w]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[f,[m,"Lenovo"],[v,A]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[f,/_/g," "],[m,"Nokia"],[v,w]],[/(pixel c)\b/i],[f,[m,M],[v,A]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[f,[m,M],[v,w]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[f,[m,H],[v,w]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[f,"Xperia Tablet"],[m,H],[v,A]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[f,[m,"OnePlus"],[v,w]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[f,[m,I],[v,A]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[f,/(.+)/g,"Fire Phone $1"],[m,I],[v,w]],[/(playbook);[-\w\),; ]+(rim)/i],[f,m,[v,A]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[f,[m,N],[v,w]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[f,[m,x],[v,A]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[f,[m,x],[v,w]],[/(nexus 9)/i],[f,[m,"HTC"],[v,A]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[m,[f,/_/g," "],[v,w]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[f,[m,"Acer"],[v,A]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[f,[m,"Meizu"],[v,w]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[f,[m,"Sharp"],[v,w]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,f,[v,w]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,f,[v,A]],[/(surface duo)/i],[f,[m,U],[v,A]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[f,[m,"Fairphone"],[v,w]],[/(u304aa)/i],[f,[m,"AT&T"],[v,w]],[/\bsie-(\w*)/i],[f,[m,"Siemens"],[v,w]],[/\b(rct\w+) b/i],[f,[m,"RCA"],[v,A]],[/\b(venue[\d ]{2,7}) b/i],[f,[m,"Dell"],[v,A]],[/\b(q(?:mv|ta)\w+) b/i],[f,[m,"Verizon"],[v,A]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[f,[m,"Barnes & Noble"],[v,A]],[/\b(tm\d{3}\w+) b/i],[f,[m,"NuVision"],[v,A]],[/\b(k88) b/i],[f,[m,"ZTE"],[v,A]],[/\b(nx\d{3}j) b/i],[f,[m,"ZTE"],[v,w]],[/\b(gen\d{3}) b.+49h/i],[f,[m,"Swiss"],[v,w]],[/\b(zur\d{3}) b/i],[f,[m,"Swiss"],[v,A]],[/\b((zeki)?tb.*\b) b/i],[f,[m,"Zeki"],[v,A]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],f,[v,A]],[/\b(ns-?\w{0,9}) b/i],[f,[m,"Insignia"],[v,A]],[/\b((nxa|next)-?\w{0,9}) b/i],[f,[m,"NextBook"],[v,A]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],f,[v,w]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],f,[v,w]],[/\b(ph-1) /i],[f,[m,"Essential"],[v,w]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[f,[m,"Envizen"],[v,A]],[/\b(trio[-\w\. ]+) b/i],[f,[m,"MachSpeed"],[v,A]],[/\btu_(1491) b/i],[f,[m,"Rotor"],[v,A]],[/(shield[\w ]+) b/i],[f,[m,"Nvidia"],[v,A]],[/(sprint) (\w+)/i],[m,f,[v,w]],[/(kin\.[onetw]{3})/i],[[f,/\./g," "],[m,U],[v,w]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[f,[m,z],[v,A]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[f,[m,z],[v,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,f,[v,y]],[/droid.+; (shield) bui/i],[f,[m,"Nvidia"],[v,y]],[/(playstation [345portablevi]+)/i],[f,[m,H],[v,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[f,[m,U],[v,y]],[/smart-tv.+(samsung)/i],[m,[v,E]],[/hbbtv.+maple;(\d+)/i],[[f,/^/,"SmartTV"],[m,j],[v,E]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,L],[v,E]],[/(apple) ?tv/i],[m,[f,T+" TV"],[v,E]],[/crkey/i],[[f,V+"cast"],[m,M],[v,E]],[/droid.+aft(\w)( bui|\))/i],[f,[m,I],[v,E]],[/\(dtv[\);].+(aquos)/i],[f,[m,"Sharp"],[v,E]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[m,K],[f,K],[v,E]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[v,E]],[/((pebble))app/i],[m,f,[v,S]],[/droid.+; (glass) \d/i],[f,[m,M],[v,S]],[/droid.+; (wt63?0{2,3})\)/i],[f,[m,z],[v,S]],[/(quest( 2)?)/i],[f,[m,Y],[v,S]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[v,k]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[f,[v,w]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[f,[v,A]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[v,A]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[v,w]],[/(android[-\w\. ]{0,9});.+buil/i],[f,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[_,[g,P+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[_,[g,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[g,_],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[_,g]],os:[[/microsoft (windows) (vista|xp)/i],[g,_],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[g,[_,$,et]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,"Windows"],[_,$,et]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[_,/_/g,"."],[g,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[g,"Mac OS"],[_,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[_,g],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[g,_],[/\(bb(10);/i],[_,[g,N]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[_,[g,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[_,[g,D+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[_,[g,"webOS"]],[/crkey\/([\d\.]+)/i],[_,[g,V+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[g,"Chromium OS"],_],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[g,_],[/(sunos) ?([\w\.\d]*)/i],[[g,"Solaris"],_],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[g,_]]},rt=function(t,e){if(typeof t===h&&(e=t,t=n),!(this instanceof rt))return new rt(t,e).getResult();var i=t||(typeof s!==u&&s.navigator&&s.navigator.userAgent?s.navigator.userAgent:a),r=e?X(it,e):it;return this.getBrowser=function(){var t={};return t[g]=n,t[_]=n,Q.call(t,i,r.browser),t.major=Z(t.version),t},this.getCPU=function(){var t={};return t[b]=n,Q.call(t,i,r.cpu),t},this.getDevice=function(){var t={};return t[m]=n,t[f]=n,t[v]=n,Q.call(t,i,r.device),t},this.getEngine=function(){var t={};return t[g]=n,t[_]=n,Q.call(t,i,r.engine),t},this.getOS=function(){var t={};return t[g]=n,t[_]=n,Q.call(t,i,r.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(t){return i=typeof t===c&&t.length>C?K(t,C):t,this},this.setUA(i),this};rt.VERSION=o,rt.BROWSER=G([g,_,p]),rt.CPU=G([b]),rt.DEVICE=G([f,m,v,y,w,E,A,S,k]),rt.ENGINE=rt.OS=G([g,_]),typeof e!==u?(typeof t!==u&&t.exports&&(e=t.exports=rt),e.UAParser=rt):"function"===l&&i(36)?(r=function(){return rt}.call(e,i,e,t),!(r!==n&&(t.exports=r))):typeof s!==u&&(s.UAParser=rt);var st=typeof s!==u&&(s.jQuery||s.Zepto);if(st&&!st.ua){var nt=new rt;st.ua=nt.getResult(),st.ua.get=function(){return nt.getUA()},st.ua.set=function(t){nt.setUA(t);var e=nt.getResult();for(var i in e)st.ua[i]=e[i]}}}("object"==typeof window?window:this)},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,i){var r=i(12),s=i(8),n=i(13),o=i(9).createLogger("js.client.proxyHTML5.ProxyHTML5","ProxyHTML5"),a=1,d=2,l=3,u=4,h=function(t,e){"use strict";this.type="Proxy HTML5",o.info("ProxyHTML5",{type:this.type}),this.wrapper=e,this.dom={slot:e.dom.slot,videoSlot:e.dom.videoSlot,iframe:null},this.target=null,this.targetUrl=t,this.attributes={version:null,volume:0},this.status=a,this.missingVolume=!1,this.volumeListeners=function(){this.updateVolume()}.bind(this)};h.prototype={loadProxy:function(){"use strict";this.loadJS(this.jsLoadedHandle.bind(this),this.jsLoadingError.bind(this))},loadJS:function(t,e){"use strict";var i=this.dom.slot.ownerDocument.createElement("iframe");i.style.position=this.dom.slot.style.position||"absolute",i.style.width=0,i.style.height=0,i.style.border="0 none",i.frameborder=0,navigator.userAgent.indexOf("Firefox")!=-1&&(i.src="javascript:void;"),this.dom.slot.appendChild(i),this.dom.iframe=i;var r=i.contentWindow.document.createElement("script");r.type="text/javascript",r.src=this.targetUrl,r.readyState?r.onreadystatechange=function(){"loaded"!=r.readyState&&"complete"!=r.readyState||(r.onreadystatechange=null,t())}:r.onload=function(){t()},r.onerror=function(){e()},i.contentWindow.document.body.appendChild(r)},jsLoadedHandle:function(){"use strict";try{this.target=this.dom.iframe.contentWindow.getVPAIDAd()}catch(t){return void this.notifyError(s.Proxy_HTML5_Not_Loaded(t.toString()))}void 0!==this.target&&null!==this.target?(this.dom.videoSlot.addEventListener("volumechange",this.volumeListeners,!0),this.updateVolume(!0),this.handshakeVersion(this.wrapper.attributes.version),this.initAd()):(o.error("jsLoadedHandle",{error:"VPAID HTML5 not loaded"}),this.notifyError(s.Proxy_HTML5_Not_Loaded()))},jsLoadingError:function(){"use strict";this.notifyError(s.Proxy_Script_Loading_Error(this.targetUrl))},getAdLinear:function(){"use strict";return this.sendToJS("getAdLinear")},getAdWidth:function(){"use strict";return this.sendToJS("getAdWidth")},getAdHeight:function(){"use strict";return this.sendToJS("getAdHeight")},getAdExpanded:function(){"use strict";return this.sendToJS("getAdExpanded")},getAdSkippableState:function(){"use strict";return this.sendToJS("getAdSkippableState")},getAdRemainingTime:function(){"use strict";return this.sendToJS("getAdRemainingTime")},getAdDuration:function(){"use strict";return this.sendToJS("getAdDuration")},getAdVolume:function(){"use strict";return this.sendToJS("getAdVolume")},setAdVolume:function(t){"use strict";this.sendToJS("setAdVolume",[t])},getAdCompanions:function(){"use strict";return this.sendToJS("getAdCompanions")},getAdIcons:function(){"use strict";return this.sendToJS("getAdIcons")},handshakeVersion:function(t){"use strict";this.attributes.version=this.sendToJS("handshakeVersion",[t]),this.wrapper.targetAttributes.version=this.attributes.version,o.debug("handshakeVersion",{wrapper:t,vpaid:this.attributes.version})},initAd:function(){"use strict";o.debug("initAd",{target:"vpaid HTML5"}),this.sendSubscribe();var t={AdParameters:this.wrapper.ad.adParameters||""},e={slot:this.dom.slot,videoSlot:this.dom.videoSlot};this.sendToJS("initAd",[this.wrapper.attributes.width,this.wrapper.attributes.height,this.wrapper.attributes.viewMode,this.wrapper.attributes.bitrate,t,e])},resizeAd:function(t,e,i){"use strict";this.dom.slot.style.width=t+"px",this.dom.slot.style.height=e+"px",this.dom.videoSlot.style&&this.dom.videoSlot.style.width&&this.dom.videoSlot.style.height||!this.dom.videoSlot.width||!this.dom.videoSlot.height?this.dom.videoSlot.style&&(this.dom.videoSlot.style.width=t+"px",this.dom.videoSlot.style.height=e+"px"):(this.dom.videoSlot.width=t+"px",this.dom.videoSlot.height=e+"px"),this.sendToJS("resizeAd",[t,e,i])},startAd:function(){"use strict";this.sendToJS("startAd")},stopAd:function(){"use strict";this.sendToJS("stopAd"),this.sendUnsubscribe()},pauseAd:function(){"use strict";this.sendToJS("pauseAd")},resumeAd:function(){"use strict";this.sendToJS("resumeAd")},expandAd:function(){"use strict";this.sendToJS("expandAd")},collapseAd:function(){"use strict";this.sendToJS("collapseAd")},skipAd:function(){"use strict";this.sendToJS("skipAd")},sendSubscribe:function(){"use strict";for(var t in r)this.target.subscribe(this[r[t]].bind(this),r[t],this)},sendUnsubscribe:function(){"use strict";for(var t in r)this.target.unsubscribe(this[r[t]].bind(this),r[t],this)},dispose:function(){"use strict";this.dom.videoSlot.removeEventListener("volumechange",this.volumeListeners,!0),this.dom.slot.removeChild(this.dom.iframe),this.target=null,this.wrapper.disposeFlags.target=!0},notifyError:function(t){setTimeout(function(){this.wrapper.notifyError(t)}.bind(this),0)},sendToJS:function(t,e){"use strict";if(this.target){"getAdDuration"!=t&&"getAdRemainingTime"!=t&&o.debug("sendToJS",{called:t}),void 0===e&&(e=[]);var i=null;try{this.target[t]?i=this.target[t].apply(this.target,e):o.warn("sendToJS",{message:"Unknwon method name : "+t})}catch(r){if(o.error("sendToJS",{message:"Can't send request to JS",method:t,error:r.message}),["getAdRemainingTime","getAdVolume","setAdVolume"].indexOf(t)==-1)switch(this.status){case a:this.notifyError(s.JS_Loading_Interface_Error(t));break;case d:this.notifyError(s.JS_Starting_Interface_Error(t));break;case l:this.notifyError(s.JS_Playing_Interface_Error(t))}}if(null!==i&&void 0!==i)return i}else"stopAd"==t&&this.AdStopped()},updateVolume:function(t){"use strict";try{var e=0;if(this.dom.videoSlot.muted)e=0;else if(e=this.dom.videoSlot.volume,null===e||isNaN(e)||e<0||e>1)return;var i=e!==this.attributes.volume;(i||t)&&(this.attributes.volume=e,setTimeout(function(){this.wrapper.vpaidEventHandler(r.Ad_Volume_Change,e)}.bind(this),10))}catch(n){this.missingVolume||(this.wrapper.internalLogger.sendInternalError(s.Video_Volume_Error()),this.missingVolume=!0)}},AdLoaded:function(){"use strict";this.status=d,this.wrapper.vpaidEventHandler(r.Ad_Loaded)},AdStarted:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Started)},AdStopped:function(){"use strict";this.status=u,this.wrapper.vpaidEventHandler(r.Ad_Stopped)},AdSkipped:function(){"use strict";this.status=u,this.wrapper.vpaidEventHandler(r.Ad_Skipped)},AdSkippableStateChange:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Skippable_State_Change)},AdSizeChange:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Size_Change)},AdLinearChange:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Linear_Change)},AdDurationChange:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Duration_Change)},AdExpandedChange:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Expanded_Change)},AdRemainingTimeChange:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Remaining_Time_Change)},AdVolumeChange:function(){"use strict";this.updateVolume()},AdImpression:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Impression)},AdVideoStart:function(){"use strict";this.status=l,this.wrapper.vpaidEventHandler(r.Ad_Video_Start)},AdVideoFirstQuartile:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Video_First_Quartile)},AdVideoMidpoint:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Video_Midpoint)},AdVideoThirdQuartile:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Video_Third_Quartile)},AdVideoComplete:function(){"use strict";this.status=u,this.wrapper.vpaidEventHandler(r.Ad_Video_Complete)},AdClickThru:function(t,e,i){"use strict";var s=n.validateAdClickThruData(t,e,i);this.wrapper.vpaidEventHandler(r.Ad_Click_Thru,s[0],s[1],s[2])},AdInteraction:function(t){"use strict";var e=n.validateAdInteractionData(t);this.wrapper.vpaidEventHandler(r.Ad_Interaction,e)},AdUserAcceptInvitation:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_User_Accept_Invitation)},AdUserMinimize:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_User_Minimize)},AdUserClose:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_User_Close)},AdPaused:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Paused)},AdPlaying:function(){"use strict";this.wrapper.vpaidEventHandler(r.Ad_Playing)},AdLog:function(t){"use strict";var e=n.validateAdLogData(t);this.wrapper.vpaidEventHandler(r.Ad_Log,e)},AdError:function(t,e){"use strict";var i=n.validateAdErrorData(t,e),o=i[1];switch(this.status){case a:o=s.External_Loading_Error(i[1]);break;case d:o=s.External_Starting_Error(i[1]);break;case l:o=s.External_Playing_Error(i[1]);break;default:o=s.External_Dispose_Error(i[1])}this.wrapper.vpaidEventHandler(r.Ad_Error,i[0],o)}},t.exports=h},function(t,e,i){var r=i(8),s=i(12),n=i(34),o=i(9).createLogger("js.client.internalVideoPlayer.InternalVideoPlayer","InternalVideoPlayer"),a=i(39),d=0,l=1,u=2,h=3,c=4,p=5,f=6,g=7,v=8,m=9,_=function(t,e,i){"use strict";i?this.deviceDetection=i:this.deviceDetection=new n,this.type="Creative",o.info("InternalVideoPlayer",{type:this.type}),o.debug("InternalVideoPlayer",{media:t}),this.wrapper=e,this.attributes={version:"2.0",duration:this.wrapper.ad.duration.toSecond()||-1,remainingTime:this.wrapper.ad.duration.toSecond()||0,currentTime:0,width:e.attributes.width,height:e.attributes.height,volume:1},this.isNaNDuration=!0,this.quartiles={first:!1,midPoint:!1,third:!1},this.listeners={},this.listenerSlot=null,this.videoSlot=null,this.playButton=null,this.playButtonStyle=null,this.targetUrl=t,this.status=d,this.stalledTimeout=null,this.lastTimeUpdate=null,this.missingVolume=!1};_.prototype={loadPlayer:function(){"use strict";this.videoSlot=this.wrapper.dom.videoSlot,this.videoSlot.src=this.targetUrl,this.resizeVideoSlot(),this.videoUpdateVolume();try{this.initListeners(),this.status=l,o.debug("loadPlayer",{initAd:"creative"}),this.videoSlot.load(),this.stalledTimeout=setTimeout(function(){"Edge"==this.deviceDetection.getBrowser()||"IE"==this.deviceDetection.getBrowser()?(o.warn("Edge/IE load timeout"),this.status=h,this.notifyEvent(s.Ad_Loaded)):(o.debug("Stalled timeout",{isStalled:this.status===l}),this.status===l&&this.videoStalledError())}.bind(this),3500)}catch(t){setTimeout(function(){this.wrapper.notifyError(r.Video_Load_Error())}.bind(this),0)}},getAdExpanded:function(){"use strict";return"fullscreen"===this.wrapper.attributes.viewMode},getAdSkippableState:function(){"use strict";return this.wrapper.skip.skippable},getAdRemainingTime:function(){"use strict";return this.attributes.remainingTime},getAdDuration:function(){"use strict";return this.attributes.duration},getAdVolume:function(){"use strict";return this.attributes.volume},setAdVolume:function(t){"use strict";if(this.videoSlot&&"number"==typeof t)try{t<0?t=0:t>1&&(t=1),this.videoSlot.volume=t,t>0&&this.videoSlot.muted?this.videoSlot.muted=!1:0==t&&(this.deviceDetection.getIsIOS()||this.deviceDetection.getIsAndroid())&&(this.videoSlot.muted=!0)}catch(e){this.missingVolume||(this.wrapper.internalLogger.sendInternalError(r.Video_Volume_Error()),this.missingVolume=!0)}},getAdCompanions:function(){"use strict";return""},getAdIcons:function(){"use strict";return!1},handshakeVersion:function(t){"use strict"},initAd:function(){"use strict"},resizeAd:function(t,e,i){"use strict";this.attributes.width=t,this.attributes.height=e,this.videoSlot&&(this.resizeVideoSlot(),this.notifyEvent(s.Ad_Size_Change))},startAd:function(){"use strict";if(this.videoSlot){if(this.status===h){this.notifyEvent(s.Ad_Started),this.status=c;try{var t=this.videoSlot.play();void 0!==t&&t["catch"](function(t){t&&"NotSupportedError"===t.name||(o.debug("startAd",{message:"autoplay is blocked by Webkit"}),this.status=p,this.showPlayButton())}.bind(this))}catch(e){setTimeout(function(){this.wrapper.notifyError(r.Video_Play_Error())}.bind(this),0)}}this.status===u&&this.notifyEvent(s.Ad_Started)}},stopAd:function(){"use strict";!this.videoSlot||this.status!==h&&this.status!==c&&this.status!==f&&this.status!==g&&this.status!==v&&this.status!==m||(this.pauseAd(),this.videoStop()),this.status!==v&&(this.status=m)},pauseAd:function(){"use strict";if(this.videoSlot)try{this.videoSlot.pause()}catch(t){setTimeout(function(){this.wrapper.notifyError(r.Video_Pause_Error())}.bind(this),0)}},resumeAd:function(){"use strict";this.videoSlot&&this.videoSlot.play()},expandAd:function(){"use strict"},collapseAd:function(){"use strict"},skipAd:function(){"use strict";this.status=v,this.stopAd()},dispose:function(){"use strict";this.hidePlayButton(),this.removeListeners(),this.wrapper.disposeFlags.target=!0},notifyError:function(t){"use strict";this.status===f||this.status===g?this.wrapper.internalLogger.sendInternalError(t):(setTimeout(function(){this.wrapper.notifyError(t)}.bind(this),0),this.status=m)},notifyEvent:function(t,e,i,r){
"use strict";setTimeout(function(){this.wrapper.vpaidEventHandler(t,e,i,r)}.bind(this),0)},resizeVideoSlot:function(){"use strict";try{this.videoSlot&&this.videoSlot.style&&(this.videoSlot.style.width&&this.videoSlot.style.height||!this.videoSlot.width||!this.videoSlot.height?(this.videoSlot.style.width=this.attributes.width+"px",this.videoSlot.style.height=this.attributes.height+"px"):(this.videoSlot.width=this.attributes.width,this.videoSlot.height=this.attributes.height))}catch(t){o.warn("resizeVideoSlot",{err:"video dimension unreachable"})}},initListeners:function(){"use strict";this.listeners.abort=function(){this.videoAbortError()}.bind(this),this.listeners.canplay=function(){this.videoLoaded()}.bind(this),this.listeners.ended=function(){this.videoStop()}.bind(this),this.listeners.error=function(){this.videoError()}.bind(this),this.listeners.loadedmetadata=function(){this.videoMetaData()}.bind(this),this.listeners.pause=function(){this.videoPause()}.bind(this),this.listeners.play=function(){this.videoStarted()}.bind(this),this.listeners.playing=function(){this.videoPlaying()}.bind(this),this.listeners.stalled=function(){this.videoStalledError()}.bind(this),this.listeners.timeupdate=function(){this.videoUpdateTime()}.bind(this),this.listeners.volumechange=function(){this.videoUpdateVolume()}.bind(this),this.listeners.click=function(){this.videoClick()}.bind(this);for(var t in this.listeners)this.listeners.hasOwnProperty(t)&&this.videoSlot.addEventListener(t,this.listeners[t]);this.listenerSlot=function(){this.videoClick()}.bind(this),this.wrapper.dom.slot.addEventListener("click",this.listenerSlot)},removeListeners:function(){"use strict";try{if(this.videoSlot){for(var t in this.listeners)this.listeners.hasOwnProperty(t)&&this.listeners[t]&&(this.videoSlot.removeEventListener(t,this.listeners[t]),this.listeners[t]=null);this.listenerSlot&&(this.wrapper.dom.slot.removeEventListener("click",this.listenerSlot),this.listenerSlot=null)}}catch(e){this.wrapper.internalLogger.sendInternalError(r.Video_Remove_Event_Error())}},videoLoaded:function(){"use strict";if(this.stalledTimeout&&(clearTimeout(this.stalledTimeout),this.stalledTimeout=null),this.status===l&&(this.notifyEvent(s.Ad_Loaded),this.isNaNDuration&&this.videoUpdateDuration(),this.status=h),this.status===u){this.status=c,this.videoMetaData();try{this.videoSlot.play()}catch(t){setTimeout(function(){this.wrapper.notifyError(r.Video_Play_Error())}.bind(this),0)}}},videoStarted:function(){"use strict";this.hidePlayButton(),this.status===p&&(this.notifyEvent(s.Ad_Impression),this.notifyEvent(s.Ad_Video_Start),this.status=f)},videoError:function(){"use strict";var t="void";if(this.status===l||this.status===u||this.status===h?t="loading":this.status===c||this.status===p?t="starting":this.status!==f&&this.status!==g||(t="playing"),this.videoSlot.error)try{switch(this.videoSlot.error.code+"|"+t){case this.videoSlot.error.MEDIA_ERR_ABORTED+"|starting":this.notifyError(r.Video_Tag_Starting_Abort_Error());break;case this.videoSlot.error.MEDIA_ERR_ABORTED+"|playing":this.notifyError(r.Video_Tag_Playing_Abort_Error());break;case this.videoSlot.error.MEDIA_ERR_NETWORK+"|loading":case this.videoSlot.error.MEDIA_ERR_NETWORK+"|starting":this.notifyError(r.Video_Network_Error());break;case this.videoSlot.error.MEDIA_ERR_NETWORK+"|playing":this.notifyError(r.Video_Network_Error_While_Playing());break;case this.videoSlot.error.MEDIA_ERR_DECODE+"|loading":case this.videoSlot.error.MEDIA_ERR_DECODE+"|starting":this.notifyError(r.Media_File_Display_Error(this.targetUrl));break;case this.videoSlot.error.MEDIA_ERR_DECODE+"|playing":this.notifyError(r.Media_File_Display_Error_While_Playing(this.targetUrl));break;case this.videoSlot.error.MEDIA_ERR_SRC_NOT_SUPPORTED+"|loading":case this.videoSlot.error.MEDIA_ERR_SRC_NOT_SUPPORTED+"|starting":this.notifyError(r.Video_Src_Not_Supported_Error(this.targetUrl));break;case this.videoSlot.error.MEDIA_ERR_SRC_NOT_SUPPORTED+"|playing":this.notifyError(r.Video_Src_Not_Supported_Error_While_Playing(this.targetUrl))}return}catch(e){}"loading"==t?this.notifyError(r.Video_Tag_Loading_Default_Error()):"starting"==t?this.notifyError(r.Video_Tag_Starting_Default_Error()):"playing"==t&&this.notifyError(r.Video_Tag_Playing_Default_Error())},videoAbortError:function(){"use strict";this.status===c||this.status===p?this.notifyError(r.Video_Tag_Starting_Abort_Error()):this.status!==f&&this.status!==g||this.notifyError(r.Video_Tag_Playing_Abort_Error())},videoStalledError:function(){"use strict";this.stalledTimeout&&(clearTimeout(this.stalledTimeout),this.stalledTimeout=null),this.status===l&&(this.wrapper.internalLogger.sendInternalError(r.Video_Tag_Stalled_Error()),this.notifyEvent(s.Ad_Loaded),this.status=u)},videoPause:function(){"use strict";this.status!==f||this.videoSlot.ended||(this.notifyEvent(s.Ad_Paused),this.status=g)},videoPlaying:function(){"use strict";this.status===c?(this.notifyEvent(s.Ad_Impression),this.notifyEvent(s.Ad_Video_Start),this.status=f):this.status===g&&(this.notifyEvent(s.Ad_Playing),this.status=f)},videoStop:function(){"use strict";if(this.status===v)this.notifyEvent(s.Ad_Skipped);else if(this.status===f||this.status===g){if(this.wrapper.attributes.isIOS&&Math.abs(this.attributes.duration-this.attributes.currentTime)>.1)return this.videoSlot.pause(),this.videoSlot.currentTime=this.attributes.currentTime,void this.videoSlot.play();this.removeListeners(),Math.abs(this.attributes.duration-this.videoSlot.currentTime)<=.1&&this.notifyEvent(s.Ad_Video_Complete),this.notifyEvent(s.Ad_Stopped)}this.status=d},videoMetaData:function(){"use strict";this.videoUpdateDuration(),this.videoUpdateVolume()},videoUpdateDuration:function(){"use strict";try{isNaN(this.videoSlot.duration)||(this.attributes.duration=this.videoSlot.duration,this.attributes.remainingTime=this.videoSlot.duration,this.isNaNDuration=!1)}catch(t){setTimeout(function(){this.wrapper.notifyError(r.Video_Metadata_Error())}.bind(this),0)}},videoUpdateTime:function(){"use strict";try{if(this.status===u&&(o.debug("Unstalled iOS"),this.videoMetaData(),this.status=h),this.status===c&&(this.notifyEvent(s.Ad_Impression),this.notifyEvent(s.Ad_Video_Start),this.status=f),this.status===f||this.status===g){this.isNaNDuration&&!this.quartiles.first&&this.videoUpdateDuration();var t=!0;if(this.wrapper.attributes.isIOS){var e=1e5,i=Date.now();this.lastTimeUpdate&&(e=(i-this.lastTimeUpdate)/1e3,e+=.1),this.lastTimeUpdate=i,Math.abs(this.videoSlot.currentTime-this.attributes.currentTime)>e&&(this.videoSlot.currentTime=this.attributes.currentTime,t=!1)}t&&(this.attributes.currentTime=this.videoSlot.currentTime,this.attributes.remainingTime=this.attributes.duration-this.videoSlot.currentTime,this.videoSlot.currentTime>=this.attributes.duration/4&&!this.quartiles.first?(this.quartiles.first=!0,this.notifyEvent(s.Ad_Video_First_Quartile)):this.videoSlot.currentTime>=this.attributes.duration/2&&!this.quartiles.midPoint?(this.quartiles.midPoint=!0,this.notifyEvent(s.Ad_Video_Midpoint)):this.videoSlot.currentTime>=3*this.attributes.duration/4&&!this.quartiles.third&&(this.quartiles.third=!0,this.notifyEvent(s.Ad_Video_Third_Quartile)))}}catch(n){setTimeout(function(){this.wrapper.notifyError(r.Video_Timing_Error())}.bind(this),0)}},videoUpdateVolume:function(){"use strict";try{this.videoSlot.muted?this.attributes.volume=0:isNaN(this.videoSlot.volume)||null===this.videoSlot.volume||(this.attributes.volume=this.videoSlot.volume,this.attributes.volume<0?this.attributes.volume=0:this.attributes.volume>1&&(this.attributes.volume=1)),this.notifyEvent(s.Ad_Volume_Change)}catch(t){this.missingVolume||(this.wrapper.internalLogger.sendInternalError(r.Video_Volume_Error()),this.missingVolume=!0)}},videoClick:function(){"use strict";this.status===f||this.status===g?this.wrapper.vpaidEventHandler(s.Ad_Click_Thru,"","",!0):this.status===p&&(this.hidePlayButton(),this.videoSlot.play())},showPlayButton:function(){"use strict";if(!this.playButtonStyle){this.playButtonStyle=this.wrapper.dom.slot.ownerDocument.createElement("style"),this.playButtonStyle.appendChild(this.wrapper.dom.slot.ownerDocument.createTextNode("")),this.wrapper.dom.slot.appendChild(this.playButtonStyle);var t=this.playButtonStyle.sheet,e=".anPlayButton";this.wrapper.dom.slot.id&&(e="#"+this.wrapper.dom.slot.id+">"+e);for(var i=[{selector:e,rule:"width: 0;height:32px;top:50%;left:50%;background-color:transparent;border:1px solid black;position:relative;transform:translate(-16px, -16px);cursor:pointer; z-index: "+a.PLAY_BUTTON_ZINDEX+";"},{selector:e+"::before",rule:"content: '';position:absolute;top:0px;left:1px;width:0;height:0;border-style:solid;border-width:16px 0 16px 34px;border-color:transparent transparent transparent black;"},{selector:e+"::after",rule:"content:'';position:absolute;top:0;left:0;width:0;height:0;border:16px solid transparent;border-left:16px solid white;border-style:solid;border-width: 16px 0 16px 34px;border-color:transparent transparent transparent white;"},{selector:e+":hover::after",rule:"border-left-color:rgb(128,128,128);"}],r=0;r<i.length;r++){var s=i[r];"addRule"in t?t.addRule(s.selector,s.rule,0):"insertRule"in t&&t.insertRule(s.selector+"{"+s.rule+"}",0)}}this.playButton||(this.playButton=this.wrapper.dom.slot.ownerDocument.createElement("div"),this.playButton.setAttribute("class","anPlayButton"),this.wrapper.dom.slot.appendChild(this.playButton))},hidePlayButton:function(){"use strict";this.playButtonStyle&&(this.wrapper.dom.slot.removeChild(this.playButtonStyle),this.playButtonStyle=null),this.playButton&&(this.wrapper.dom.slot.removeChild(this.playButton),this.playButton=null)}},t.exports=_},function(t,e){var i={AD_ICON_ZINDEX:2147483647,SKIP_BUTTON_ZINDEX:2147483647,PLAY_BUTTON_ZINDEX:2147483647};t.exports=i},function(t,e,i){var r=i(9).createLogger("js.trackingEvent.AdIcons","AdIcons"),s=i(39),n=function(t){r.debug("",{messsage:t})},o={getMsecTime:function(t){return t.toSecond()}},a=function(){var t=5,e=function(t){for(var e=0;e<t.length;e++){var i=["image/gif","image/jpeg","image/png"],r=["application/x-shockwave-flash"],s=t[e].StaticResource;if(s&&s.type){n("setContents for "+t[e].program);var o=t[e].width,a=t[e].height;i.indexOf(s.type.toLowerCase())>=0&&(t[e].content="<img src='"+s.src+"' width='"+o+"' height='"+a+"'>"),r.indexOf(s.type.toLowerCase())>=0&&(t[e].content="<object type='application/x-shockwave-flash' data='"+s.src+"' width='"+o+"' height='"+a+"' style='width:"+o+";height:"+a+";'><param name='allowScriptAccess' value='always'><param name='allowNetworking' value='all'><param name='allowNetworking' value='all'><param name='mode' value='opaque'><param name='allowFullScreen' value='true'></object>"),t[e].isDisplay=!1}}return t};this.icons=[],this.init=function(t){n("initalize ad icon"),t&&(this.icons=e(t))},this.getIcons=function(){return this.icons},this.renderIcons=function(e,i,r,a,d,l,u){var h=this.getIcons(),c=this;if(d=0!==d?d+t:d,h&&!(h.length<1)){var p,f=function(t){return function(r){r.stopPropagation(),i(t.IconClickThrough),e("IconClickTracking_"+t.program),n("fire IconClickTracking for "+t.program)}},g=function(t){setTimeout(function(){c.resolveCollision(t),n("start to check a collision of ad icon")},500)};for(p=0;p<h.length;p++){var v,m,_=h[p],b=_.htmlReference;if(_&&(_.duration&&(v=o.getMsecTime(_.duration)),_.offset&&(m=o.getMsecTime(_.offset))),v<=0&&(v=u),!(l<m)&&0!==l){var y;if(u>0&&l>=u){for(y=0;y<h.length;y++){var w=h[y],A=w.htmlReference;A&&(A.style.display="none",w.isDisplay=!1)}return void n("hide whole ad icons because video is finished by "+l+"ms")}if(l>m+v&&_.isDisplay&&b)b.style.display="none";else if(!_.isDisplay){var E="left",S=Number(S)<0?0:S,k="top",C=Number(S)<0?0:S,I=Number(a)>0?a:0,T=Number(d)>0?d:0;_&&"left"===_.xPosition&&(E="left",S=0),_&&"right"===_.xPosition&&(E="right",S=0),_&&Number(_.xPosition)>=0&&(E="left",S=Number(_.xPosition)),_&&"bottom"===_.yPosition&&(k="bottom",C=0,C+=T),_&&"top"===_.yPosition&&(k="top",C=0,C+=I),_&&Number(_.yPosition)>=0&&(k="top",C=Number(_.yPosition),C+=I);var x;b?(x=b,n("reuse ad icon for "+_.program)):(x=r.ownerDocument.createElement("div"),n("create ad icon for "+_.program)),r.appendChild(x),x.setAttribute("name","adicon"),x.id="adicon_"+_.program,x.innerHTML=_.content,x.style.position="absolute",x.style.cursor="pointer",x.style[E]=S+"px",x.style[k]=C+"px",x.style.zIndex=s.AD_ICON_ZINDEX,x.style.display="block",x.style.width=_.width+"px",x.style.height=_.height+"px",_.isDisplay=!0,_.htmlReference=x,_.document=r.ownerDocument,_.originalStyle={},_.originalStyle[E]=S,_.originalStyle[k]=C,_.clickRegisterd||(x.addEventListener("click",f(_)),_.clickRegisterd=!0,n("ad icon click handler registered for "+_.program)),h[p]=_,e&&"function"==typeof e&&(e("IconViewTracking_"+_.program),n("check and fire IconViewTracking for "+_.program)),p===h.length-1&&g(h)}}}}},this.elementsFromPoint=function(t,e,i){try{if(i.elementsFromPoint)return i.elementsFromPoint(t,e);var r=[],s=void 0;do s!==i.elementFromPoint(t,e)?(s=i.elementFromPoint(t,e),r.push(s),s&&s.style&&(s.style.pointerEvents="none")):s=!1;while(s);return r.forEach(function(t){var e;return t&&t.style&&(e=t.style.pointerEvents="all"),e}),r}catch(o){return n(o),null}};var i=function(t){var e=0;return t&&Number(t)>=0&&(e=Number(t)),t&&"string"==typeof t&&t.toLowerCase()&&t.indexOf("px")&&(e=Number(t.replace("px","")),e=e>0?e:0),e};this.resolveCollision=function(t){var e,r=this,s=function(t,e){var r;for(r=0;r<t.length;r++){var s=t[r];if(s&&"adicon"===s.getAttribute("name")&&e!=s){var n=i(s.clientWidth),o=i(s.clientHeight),a=i(s.style.left),d=i(s.style.right);return{result:!0,width:n,height:o,left:a,right:d}}}return{result:!1,width:0,height:0,left:0,right:0}},o=function(t,e,i,n,o,a,d,l,u){var h,c;"left"===t&&(h=e-a-1,c=i-a-1),"right"===t&&(h=e+a+1,c=i+a+1);var p=r.elementsFromPoint(h,n,l),f=r.elementsFromPoint(c,n,l),g=r.elementsFromPoint(c,o,l),v=r.elementsFromPoint(h,o,l),m=s(p,u),_=s(f,u),b=s(g,u),y=s(v,u);return{newSpaceOwner_topLeft:m,newSpaceOwner_topRight:_,newSpaceOwner_bootomRight:b,newSpaceOwner_bootomLeft:y,next_left:h,next_right:c}};for(e=1;e<t.length;e++){var a=t[e];if(a.htmlReference){var d=a.htmlReference.getBoundingClientRect(),l=d.left,u=d.top,h=d.right,c=d.bottom,p=r.elementsFromPoint(l,u,a.document),f=r.elementsFromPoint(h,u,a.document),g=r.elementsFromPoint(h,c,a.document),v=r.elementsFromPoint(l,c,a.document),m=s(p,a.htmlReference),_=s(f,a.htmlReference),b=s(g,a.htmlReference),y=s(v,a.htmlReference),w=a.program;if(m.result||b.result||_.result||y.result){n("collision detection starts for ad icon program - "+w);var A=m.width||b.width||_.width||y.width,E=m.height||b.height||_.height||y.height,S=m.left||b.left||_.left||y.left;A+=S;var k=!1,C=o("left",l,h,u,c,A,E,a.document,a.htmlReference);k===!1&&C.newSpaceOwner_topLeft.result===!1&&C.newSpaceOwner_topRight.result===!1&&C.newSpaceOwner_bootomRight.result===!1&&C.newSpaceOwner_bootomLeft.result===!1&&C.next_left>=0&&(n("collision resolved by moving icon to left for ad icon program - "+w),a.htmlReference.style.left=C.next_left+"px",k=!0),C=o("right",l,h,u,c,A,E,a.document,a.htmlReference),k===!1&&C.newSpaceOwner_topLeft.result===!1&&C.newSpaceOwner_topRight.result===!1&&C.newSpaceOwner_bootomRight.result===!1&&C.newSpaceOwner_bootomLeft.result===!1&&(n("collision resolved by moving icon to right for ad icon program - "+w),a.htmlReference.style.left=C.next_left+"px",k=!0),k===!1&&(n("hide ad-icon due to no way to avoid collision for ad icon program - "+w),a.htmlReference.style.display="none"),n("collision detection end for ad icon program - "+w)}}}},this.redraw=function(t){n("start reposition"),n("offsetHeight: "+t);var e;for(e=0;e<this.icons.length;e++){var i=this.icons[e],r=i.htmlReference,s=i.originalStyle;if(s){var o=s.bottom;(o||0===o)&&("bottom"===o&&(o=0),r.style.bottom=o+t+"px")}}n("end reposition")}};t.exports=a},function(t,e){t.exports={Not_Implemented:-1,Unknown:-2}},function(t,e,i){var r=i(16),s=i(8),n=i(10),o=i(9).createLogger("js.utils.InternalErrorUtils","InternalErrorUtils"),a=10,d="https://rb.adnxs-simple.com/pack?log=log_rb_vpaid_wrapper_signals&format=json",l=function(t,e){"use strict";try{parent.XMLHttpRequest&&(r.XMLHttpRequest=parent.XMLHttpRequest)}catch(i){o.warn("unable to get parent XHR")}this.xhr=e||r,this.count=0,this.auctionID=1,this.buyerMemberID=0,this.sellerMemberID=0,this.creativeID=0,this.placementID=0,this.pendingLogsCount=0,this.disposeDelay=50,this.disposeTimeout=null,this.init(t)};l.prototype={sendInternalError:function(t){"use strict";var e=this.postMessage(t);switch(t.severity){case s.SEVERITY.INFO:case s.SEVERITY.DEBUG:o.debug("sendInternalError",e);break;case s.SEVERITY.WARN:o.warn("sendInternalError",e);break;default:o.error("sendInternalError",e)}return e},sendDebug:function(t){"use strict";var e=this.postMessage({code:0,severity:s.SEVERITY.DEBUG,message:t});return o.debug("sendDebug",e),e},postMessage:function(t){"use strict";if(this.count++>=a)return o.error("Max internal log reached",t),{};var e={auction_id_64:this.auctionID,buyer_member_id:this.buyerMemberID,seller_member_id:this.sellerMemberID,creative_id:this.creativeID,tag_id:this.placementID,version:10,severity:t.severity,code:t.code,message:String(t.message)},i=JSON.stringify(e).replace(/"auction_id_64":"(\d+)"/,'"auction_id_64":$1');if(navigator.sendBeacon)try{var r=navigator.sendBeacon(d,i);r||o.error("Beacon request not queued in the navigator")}catch(s){o.error("Error caught on Beacon method",{error:s.message})}else{o.debug("Send internal log using XHR"),this.pendingLogsCount++;try{this.xhr({uri:d,body:i,method:"POST"},function(t,e,i){this.pendingLogsCount--,t&&o.error("Unable to send internal log to ratbait",{error:t.message})}.bind(this))}catch(s){o.error("Error caught on XHR method",{error:s.message}),this.pendingLogsCount--}}return e},init:function(t){"use strict";var e=n.getANWrapperParameter("ratbaitEndPoint");return e&&(d=decodeURIComponent(e),o.debug("Ratbait endpoint",{endpoint:d})),t?(o.info("Init internal logger",{rblog:t}),void this.parseInternalLogConfig(t)):void o.warn("No internal log config set")},parseInternalLogConfig:function(t){"use strict";for(var e=String(t).split(/;/g),i=0;i<e.length;i++){var r=e[i].split(/=/);if(2==r.length)try{this.saveKeyValuePair(r[0],r[1])}catch(s){o.warn("Saving key-value pair failed when configuring internal logs",s)}}},saveKeyValuePair:function(t,e){"use strict";return t?("auc"===t&&null!==e&&void 0!==e&&""!==e&&"0"!=e&&(/^[0-9]+$/.test(e)?this.auctionID=e:this.auctionID=1),"bm"===t&&(this.buyerMemberID=parseInt(e)||0),"sm"===t&&(this.sellerMemberID=parseInt(e)||0),"cr"===t&&(this.creativeID=parseInt(e)||0),void("pl"===t&&(this.placementID=parseInt(e)||0))):void o.warn("Trying to save an empty config")},dispose:function(t){"use strict";return 0==this.pendingLogsCount?void(t.disposeFlags.internalLogger=!0):void(this.disposeTimeout=setInterval(function(){0==this.pendingLogsCount&&(t.disposeFlags.internalLogger=!0,clearInterval(this.disposeTimeout))}.bind(this),this.disposeDelay))}},t.exports=l},function(t,e,i){var r=i(32),s=i(8);t.exports={validate:function(t){var e=[];if(0!==t.length)for(var i=0;i<t.length;i++){var n=t[i];n.nodeLocation===r.Ad_Verifications_Node_Name?e.push(s.Vast_OMID_AdVerifications_Node_Present()):n.nodeLocation===r.Extension_Node_Name&&e.push(s.Vast_OMID_Extensions_AdVerifications_Node_Present()),"omid"!==n.apiFramework&&e.push(s.Vast_OMID_AdVerification_APIFramework_Not_OMID())}return e}}},function(t,e,i){var r=i(9),s=r.createLogger("js.utils.MSANViewabilityUtils","MSANViewabilityUtils"),n=function(t,e,i,r){"use strict";this.originalConfig=t||{},this.MSANTrkjsConfig=e,this.MSANIasConfig=i,this.MSANDvConfig=r,this.mergedConfig=null};n.PROVIDER_CODES=Object.freeze({IAS:"ias",DV:"dv"}),n.prototype={_deepCopy:function(t){"use strict";return null===t||"object"!=typeof t?t:Array.isArray(t)?t.map(this._deepCopy.bind(this)):Object.keys(t).reduce(function(e,i){return e[i]=this._deepCopy(t[i]),e}.bind(this),{})},_updateProvider:function(t,e,i){"use strict";for(var r=-1,n=0;n<t.third_party_providers.length;n++)if(t.third_party_providers[n].code===e){r=n;break}r!==-1?(s.warn("Overwriting Impbus viewability config for provider: "+e),t.third_party_providers[r].config=i):t.third_party_providers.push({code:e,config:i})},mergeConfig:function(){"use strict";return this.mergedConfig=this._deepCopy(this.originalConfig),this.MSANTrkjsConfig&&/^native_event=[^&]+$/.test(this.MSANTrkjsConfig)&&(this.mergedConfig.config+="&"+this.MSANTrkjsConfig),this.mergedConfig.third_party_providers||(this.mergedConfig.third_party_providers=[]),this.MSANIasConfig&&this._updateProvider(this.mergedConfig,n.PROVIDER_CODES.IAS,this.MSANIasConfig),this.MSANDvConfig&&this._updateProvider(this.mergedConfig,n.PROVIDER_CODES.DV,this.MSANDvConfig),this.mergedConfig}},t.exports=n}]);
